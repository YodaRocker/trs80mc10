1 REM BOULDER DASH ENGINE
2 REM  FABRIZIO RADICA
3 REM N3=N1-(N2*INT(N1/N2)):RETURN

10 CLS:CLEAR1200:MX=20:MY=10:VX=2:VY=3

100 REM READ MAP
110 FOR Y=1 TO MY
120 READ A$:M$=M$+A$
130 NEXT Y

135 PRINT@32*1+1,"¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿"
140 L=MX*MY
150 FOR P=21 TO L
160 Y=INT(P/20+1)
170 X=P-(20*INT(P/20)):IFX=0THENX=20:Y=Y-1

180 PRINT@32*Y+X,;
185 A$=MID$(M$,P,1)
190 IFA$="2"THENPRINT"€";:GOTO220
200 IFA$="3"THENPRINT"O";:GOTO220
210 IFA$="1"ANDP>20THENPRINT"¿";
220 NEXT
225 PRINT@32*11+1,"¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿";
230 PRINT@32*13+1,"BOULDER DASH ENGINE"
240 PRINT@32*14+1,"FABRIZIO RADICA"
250 M$=LEFT$(M$,(VY-1)*20+VX-1)+"0"+MID$(M$,(VY-1)*20+VX+1):PRINT@32*VX+VY,"X";:REM START PLAYER POSITION

300 FORZ=0TO1STEP0:REM MAIN LOOP
310 GOSUB2000:REM CALL PLAYER MOVEMENTS
360 GOSUB5000
380 NEXT:STOP

1000 REM MAP DATA
1010 DATA "11111111111111111111"
1020 DATA "12223222222222222221"
1030 DATA "12333222233222222221"
1040 DATA "12222222223333222221"
1050 DATA "12222222222223222221"
1060 DATA "12333322222233332221"
1070 DATA "12222222223332222221"
1080 DATA "12222223222222233221"
1090 DATA "12222333222222222221"
1100 DATA "12222222222222222221"

1999 REM PLAYER MOVEMENTS AND COLLISIONS CHECK.
2000 Y=(VY-1)*20:K=PEEK(2)ANDPEEK(17023)
2010 IFK=83THENGOSUB6000
2100 IFK=65THENGOSUB6100
2200 IFK=87THENGOSUB6200
2300 IFK=90THENGOSUB6300
2400 RETURN

3000 SOUND1,1:PRINT@32*VY+VX,"X";:RETURN:REM PLAYER

5000 IFMID$(M$,P+20,1)<>"0"THENRETURN
5500 Y=INT(P/20+1)
5510 X=P-(20*INT(P/20)):IFX=.THENX=20:Y=Y-1

5520 PRINT@32*Y+X," ";
5530 PRINT@32*(Y+1)+X,"O";
5550 M$=LEFT$(M$,P-1)+"0"+MID$(M$,P+1)
5560 M$=LEFT$(M$,P+19)+"3"+MID$(M$,P+21)
5570 RETURN

6000 A$=MID$(M$,Y+VX+1,1):IFA$<>"1"THENIFA$<>"3"THENGOSUB7000:VX=VX+1:GOTO3000
6010 RETURN

6100 A$=MID$(M$,Y+VX-1,1):IFA$<>"1"THENIFA$<>"3"THENGOSUB7000:VX=VX-1:GOTO3000
6110 RETURN

6200 A$=MID$(M$,Y-20+VX,1):IFA$<>"1"THENIFA$<>"3"THENGOSUB7000:VY=VY-1:GOTO3000
6210 RETURN

6300 IFVY=10THENRETURN
6310 A$=MID$(M$,Y+20+VX,1):IFA$<>"1"ANDA$<>"3"THENGOSUB7000:VY=VY+1:GOTO3000
6320 RETURN

7000 PRINT@32*VY+VX," ";:M$=LEFT$(M$,Y+VX-1)+"0"+MID$(M$,Y+VX+1)
7010 RETURN
