0 DIM K(255),S(3):K(87)=1:K(83)=2:K(90)=3:K(65)=4
1 REM
2 REM oldgame by Tinyan
3 REM
4 REM MC-10 EDITS JIM GERRIE
10 DIMHX(4),HY(4)
11 DIMBK(32,16),CH$(10)
12 DIMEX(4),EY(4),EH(4)
13 DIMNH(8)
14 DIMSN$(5)
20 FORI=0TO3:READHX(I),HY(I):NEXT
21 FORI=0TO9:READCH$(I):IFCH$(I)="2"THENCH$(I)=CHR$(92)
22 NEXT
23 FORI=0TO7:READNH(I):NEXT
24 FORI=0TO4:READSN$(I):NEXT:READS(1),S(2),S(3)
40 REM PLAY "l64o5t255v15"
50 GOSUB10000
60 GOSUB11000
70 GOSUB30000
100 SD=0
105 S=K(PEEK(2)ANDPEEK(17023)):IFS<1THEN200
110 S=S-1
111 NX=PX+HX(S):NY=PY+HY(S)
112 B=BK(NX,NY)
113 IFB=0THENGOSUB2000:GOTO190
114 IFB=2ORB=3THENGOSUB3000:GOTO190
115 IFB=4THENPX=NX:PY=PY:GOTO400
190 PRINT@32*PY+PX,"@";
200 GM=0
210 FORI=0TOEN
220 X1=EX(I):Y1=EY(I):H1=EH(I)
221 D1=BK(X1,Y1)
222 IFD1=2ORD1=3THENGOSUB6000:EH(I)=H1
230 VX=HX(H1):VY=HY(H1)
231 X2=X1+VX:Y2=Y1+VY
232 D2=BK(X2,Y2)
233 IFX2=PXANDY2=PYTHENGM=1
240 IFD2=1THENGOSUB7000:EH(I)=H1:GOTO290
250 IFD2=4THENGOSUB8000
260 PRINT@32*Y1+X1,CH$(D1);
270 PRINT@32*Y2+X2,CH$(5);
280 EX(I)=X2:EY(I)=Y2
290 NEXT
299 IFGM=1THEN400
300 IFKS=0THEN500
310 IFSD>0THENSOUNDS(SD),1
399 GOTO100
400 REM
401 REM GAME OVER
402 REM
410 M$=SN$(3):GOSUB9000
411 FORI=32TO127
412 PRINT@32*PY+PX,CHR$(I);
413 NEXT
450 PRINT@32*5+5,"#############";
451 PRINT@32*6+5,"#           #";
452 PRINT@32*7+5,"# GAME OVER #";
453 PRINT@32*8+5,"#           #";
454 PRINT@32*9+5,"# REPLAY SP #";
455 PRINT@32*10+5,"#           #";
456 PRINT@32*11+5,"#############";
460 IFINKEY$<>" "THEN460
499 GOTO50
500 REM
501 REM CLEAR!
502 REM
510 M$=SN$(4):GOSUB9000
520 FORJ=1TO20
521 FORI=1TO4
522 PRINT@32*8+5,"clear!";
525 NEXT
530 NEXT
550 IFINKEY$<>" "THEN550
590 ST=ST+1:IFST>=12THENST=0
599 GOTO60
2000 PRINT@32*PY+PX," ";
2010 PX=NX:PY=NY
2099 RETURN
3000 LX=NX+HX(S):LY=NY+HY(S)
3010 B2=BK(LX,LY)
3020 IFB2<>0THENRETURN
3030 BK(LX,LY)=B
3040 BK(NX,NY)=0
3060 PRINT@32*PY+PX," ";
3070 PRINT@32*LY+LX,CH$(B);
3080 PX=NX:PY=NY
3090 SD=1
3099 RETURN
6000 H1=NH((D1-2)*4+H1)
6010 SD=2
6099 RETURN
7000 H1=H1+2:IFH1>3THENH1=H1-4
7099 RETURN
8000 KS=KS-1
8010 D1=0
8020 SD=3
8030 BK(X2,Y2)=0
8099 RETURN
9000 FORC1=1TOLEN(M$):IFMID$(M$,C1,1)="A"THENSOUND73,2
9001 IFMID$(M$,C1,1)="B"THENSOUND93,2
9002 IFMID$(M$,C1,1)="C"THENSOUND102,2
9003 IFMID$(M$,C1,1)="D"THENSOUND119,2
9004 IFMID$(M$,C1,1)="E"THENSOUND134,2
9005 IFMID$(M$,C1,1)="F"THENSOUND141,2
9006 IFMID$(M$,C1,1)="G"THENSOUND154,2
9007 NEXT:RETURN
10000 REM
10001 REM INIT NEW GAME
10002 REM
10010 ST=0
10999 RETURN
11000 REM
11001 REM INIT NEW STAGE
11002 REM
11010 GOSUB 20000
11100 PX=7:PY=7
11110 EN=ST-INT((ST/4)*4)
11200 FORJ=0TO1
11210 FORI=0TO1
11220 EX(I+J*2)=13*I+1
11230 EY(I+J*2)=13*J+1
11240 NEXT
11250 NEXT
11260 EH(0)=1
11261 EH(1)=2
11262 EH(2)=0
11263 EH(3)=3
11999 RETURN
20000 REM
20001 REM CREATE STAGE
20002 REM
20005 CLS:PRINT@32*1+1,"PLEASE WAIT..."
20010 FORI=0TO15:BK(I,0)=1:NEXT
20011 FORI=0TO15:BK(I,15)=1:NEXT
20012 FORJ=0TO15:BK(0,J)=1:NEXT
20013 FORJ=0TO15:BK(15,J)=1:NEXT
20020 FORJ=1TO14:FORI=1TO14:BK(I,J)=0:NEXT:NEXT
20030 FORJ=6TO9:FORI=6TO9:BK(I,J)=1:NEXT:NEXT
20100 K=ST*8+30
20110 FORI=0TOK
20120 RX=INT(RND(0)*14)+1
20130 RY=INT(RND(0)*14)+1
20140 D=INT(RND(0)*2)+2
20150 BK(RX,RY)=D
20160 NEXT
20170 FORJ=0TO1:FORI=0TO1:BK(1+I*13,1+J*13)=0:NEXT:NEXT
20200 K=ST*2+2
20210 KS=0
20220 FORI=0TOK
20230 RX=INT(RND(0)*12)+2
20240 RY=INT(RND(0)*12)+2
20250 IFBK(RX,RY)=1THEN20280
20260 IFBK(RX,RY)=4THEN20280
20270 BK(RX,RY)=4:KS=KS+1
20280 NEXT
20290 IFKS=0THENKS=1:BK(3,3)=4
20300 FORJ=6TO9:FORI=6TO9:BK(I,J)=0:NEXT:NEXT
20999 RETURN
30000 REM
30001 REM PRINT START SCREEN
30002 REM
30010 CLS
30020 FORJ=0TO15:FORI=0TO15
30030 D=BK(I,J):IFD=0THEN30090
30040 PRINT@32*J+I,;:PRINTCH$(D);
30090 NEXT:NEXT
30100 PRINT@32*PY+PX,CHR$(96);
30200 FORI=0TOEN
30210 PRINT@32*EY(I)+EX(I),"o";
30230 NEXT
30300 PRINT@32*5+24,"STAGE"
30310 PRINT@32*6+25,ST+1;
30999 RETURN
50000 DATA 0,-1,1,0,0,1,-1,0
50100 DATA " ","#","/","2","*"
50110 DATA "O","@"," "," "," "
50200 DATA 1,0,3,2,3,2,1,0
50300 DATA "G"
50301 DATA "CCD"
50302 DATA "CEG"
50303 DATA "BGFEGFEDFEDC"
50304 DATA "CEGEGRGC"
50305 DATA 1,102,154
