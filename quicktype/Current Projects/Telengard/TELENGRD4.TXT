0 GOTO1000
9 YY=INT(CC/64):XX=((CC/64)-YY)*64:RESET(XX,YY):RETURN
10 FORQ=0TO11:PRINT@Q*32,"                        ";:NEXT:RETURN
20 FORQ=1TO1000:NEXT:RETURN
1000 CLEAR512:P=.5
1015 S$="STRINTWISCONDEXCHR"
1020 M$="GNOLL   KOBOLD  SKELETONHOBBIT  ZOMBIE  ORC     FIGHTER MUMMY   ELF     GHOUL   DWARF   TROLL   WRAITH"
1021 MO$=M$+"  OGRE    MINOTAURGIANT   SPECTER VAMPIRE DEMON   DRAGON  "
1035 T$="REFUSESILVERGOLD  GEMS  JEWELS"
1100 DIMP(3,3),ST(5),SF(11),I$(10),I(10),P$(36),B(4),FM(20),FL(20),FH(20),N$(10,3):XO=1.6915:YO=1.4278:ZO=1.2462:WO=4694
1105 I$(1)="SWORD":I$(2)="ARMOR":I$(3)="SHIELD":I$(4)="ELVEN CLOAK":I$(5)="ELVEN BOOTS":I$(6)="RING OF REGENERATION"
1135 I$(7)="RING OF PROTECTION":I$(8)="SCROLL OF RESCUE":I$(9)="POTION OF HEALING":I$(10)="POTION OF STRENGTH"
1155 B$="RED   YELLOWGREEN BLUE":CM$="WXADSIKJL HQPC."+CHR$(31)+"RUG"
1160 FORI=1TO36:READP$(I):NEXT:FORI=1TO20:FM(I)=0:NEXT:FORI=1TO3:FORK=1TO10:READIN$(K,I):NEXT:NEXT
1162 DATAMAGIC MISSILE,SLEEP,CURE LIGHT WOUNDS,LIGHT,TURN UNDEAD,PROT/EVIL,WEB,LEVITATE,CAUSE LIGHT WNDS,DETECT TRAPS,CHARM
1166 DATASTRENGTH,LIGHTNING BOLT,CURE SERIOUS WNDS,CONTINUAL LIGHT,INVISIBILITY,HOLD MONSTER,PHANTSML FORCES
1168 DATAPASS WALL,FIREBALL,CAUSE SERIOUS WND,FLESH TO STONE,FEAR,FINGER OF DEATH
1170 DATATELEPORT,ASTRAL WALK,POWER WORD KILL,ICE STORM,WALL OF FIRE,PLAGUE
1171 DATATIME STOP,RAISE DEAD,HOLY SYMBOL,WORD OF RECALL,RESTORATION,PRISMATIC WALL
1173 DATASALTY,BOLD,LOAD,OLD,GOODLY,WORTHY,LOFTY,FINE,ROCKY,AGED,ROAD,EYE,TOOTH,DRAGON,MUG,DEMON,WHARF,BRIDGE,MEADE,ALE
1175 DATATAVERN,ALEHOUSE,CELLAR,CLUB,INN,HOUSE,INN,LODGE,MEADHALL,RESTHOUSE
1200 CLS:PRINT"WELCOME TO TELENGARD":C=0
1213 PRINT"(S)TART A NEW CHARACTER OR":PRINT"(L)OAD OLD ONE?";
1215 GOSUB9240:IFC$="@"THEN1215
1216 IFC$<>"L"THENPRINT"START":GOSUB20:GOTO1400
1220 PRINT"READ":STOP
1400 CLS:PRINT"enter TO USE STATS"
1500 FORI=0TO5:Q=0:FORQ1=1TO3:Q=Q+RND(6):NEXT:ST(I)=Q
1510 PRINTMID$(S$,I*3+1,3);ST(I):NEXT
1515 GOSUB9240:IFC$<>CHR$(13)THEN1400
1520 HP=ST(3):CH=HP:GD=0:TG=0:CZ=1:LV=1:FORI=1TO10:I(I)=0:SF(I)=0:NEXT
1525 SF(11)=0:GOSUB9288
1600 CX=25:CY=13:EX=0:SU=1:CS=1:CLS:PRINT"YOUR NAME, NOBLE SIR";
1602 INPUTNM$
1610 PRINT"YOU ARE DESCENDING INTO THE"
1620 PRINT"DEPTHS OF THE TELENGARD DUNGEON":PRINT:PRINT:PRINT:PRINT"BEWARE...";
1630 GOSUB20:CLS:L=1:GOSUB9320:GOSUB9122:SY=1:GOTO3000
2000 FORI=1TO11:SF(I)=SF(I)-1:NEXT
2005 L=CZ:GOSUB9248:IFSY=1THENGOSUB9122
2010 SY=1:IFI(6)=0ORCH=HPTHEN3000
2015 CH=CH+I(6):IFCH>HPTHENCH=HP
2020 GOSUB9320
3000 IFRND(0)>.3THEN4000
3001 IFSF(6)>0ANDRND(0)>.2THEN4000
3005 PRINT@135,"#";:M=RND(20):IFSF(7)>0ANDM<4THEN3005
3006 IFRND(20)<=I(4)THEN9378
3007 ML=INT((RND(0)^1.5)*(CZ*2+1)+1):GOSUB9352
3008 IFSF(3)>0ANDUN=1ANDRND(0)>.8THEN3005
3010 GOSUB9246:GOSUB9282:PRINT"LEVEL";ML;M$
3011 IFSF(9)>0ANDM<16ANDM<>11THENGOSUB9250:GOTO4000
3012 PRINT@336,"LEVEL"STR$(ML)" "M$;:PRINT@384,;
3015 MH=INT((RND(0)^.5)*ML*M+1):L=ML
3017 IFRND(0)>.95THENONRND(3)GOTO3030,3045,3072
3020 IFM<>9THEN3040
3025 IFRND(0)>.04*ST(5)THEN3040
3030 PRINT"THE "M$" LIKES YOUR BODY":PRINT"HE HEALS YOU TO FULL STRENGTH":CH=HP
3037 GOSUB9320:GOSUB20:GOSUB9348:PRINT@135," ";:GOTO4000
3040 IFM<>4ORRND(0)<.04*ST(5)THEN3070
3045 PRINT"THE ";M$;" MAKES A QUICK MOVE":GOSUB20
3050 FORI=1TO10:IFI(I)>0THEN3056
3052 NEXT:PRINT"YOU HAVE NOTHING HE WANTS TO STEAL!":GOTO3037
3056 PRINT"HE STEALS ";:IFI<8THENPRINT"YOUR ";I$(I):I(I)=0:GOTO3037
3060 PRINT"A ";I$(I):I(I)=I(I)-1:GOTO3037
3070 IFM<>20ORRND(0)*30>ST(3)THEN3090
3072 I=RND(7):IFI(I)>=MLTHEN3090
3074 C=ML-I(I):C=RND(C):I(I)=I(I)+C
3076 PRINT"THE "M$" LIKES YOU!":GOSUB9250
3078 PRINT"HE GIVES YOU A "I$(I)" +"I(I):GOSUB9320:GOSUB9250
3080 PRINT@135," ";:GOSUB9348:GOTO4000
3090 IFRND(0)>.5+ST(4)*.02THEN3300
3100 PRINT"fIGHT, cAST, OR eVADE:";:GOSUB9240
3102 IFC$="@"THENPRINT"WAIT"
3105 FORI=1TO7:IFMID$("FCE0."+CHR$(13)+"@",I,1)=C$THEN3115
3110 NEXT:PRINT"THE ";M$;" IS NOT AMUSED":GOSUB9250:GOTO3100
3115 ONIGOTO3200,3400,3700,3200,3400,3700,3300
3200 I=INT(RND(0)*20)+LV+I(1)+ST(0)/2:PRINT"FIGHT"
3202 IFSF(1)>0THENI=I+4
3204 IFI<10THENPRINT"YOU MISSED...":GOTO3300
3205 I=INT(RND(0)*8+RND(0)*LV*2+I(1)+1):IFSF(1)>0THENI=I+5
3207 PRINT"YOU DO";I;"POINTS OF DAMAGE"
3210 MH=MH-I:IFMH>0THEN3300
3220 PRINT"IT DIED...";
3223 CC=272:GOSUB9:E=ML*M*10:EX=EX+E:GOSUB20
3225 GOSUB9348:GOSUB9248:PRINT"YOU GAIN";E;"EXPERIENCE":GOSUB9320:GOSUB9252
3230 GOSUB9250:GOTO3900
3300 DB=1:PA=0:DR=0:MB=0:GOTO3330
3305 I=INT(RND(0)*20)+ML-I(2)-I(3)+MB
3306 IFM>16ANDM<20ANDSF(4)>0THENI=I-6
3310 IFI<10THENPRINT"IT MISSED...";:GOSUB9250:GOTO3100
3315 I=INT((RND(0)*8+RND(0)*ML*2+1)*DB):PRINT"IT DOES";I;"DAMAGE";
3320 CH=CH-I:GOSUB9318:IFCH<1THEN9000
3321 GOSUB20:IFRND(1)>DRORSF(4)>0THEN3326
3322 GOSUB9248:PRINT"IT DRAINS A LEVEL!":EX=INT(EX/2)
3324 GOSUB9252:GOSUB9250:GOTO3310
3326 IFRND(0)>PATHENGOSUB9250:GOTO3100
3327 GOSUB9248:PRINT"YOU'RE PARALYZED!":GOSUB9250:GOTO3300
3330 IFM=13THENDR=.1:GOTO3305
3335 IFM=17THENDR=.2:GOTO3305
3340 IFM=18THENDR=.3:PA=.3:GOTO3305
3345 IFM=10THENPA=.5:GOTO3305
3350 IFM<>19THEN3365
3352 GOSUB9250
3355 IFRND(0)>.6THENPRINT"IT USES IT'S SWORD!":MB=4:DB=3:GOTO3305
3360 PRINT"IT USES IT'S WHIP!":MB=2:DB=2:GOTO3305
3365 IFM<>20THEN3305
3370 IFRND(0)>.3THENMB=5:DB=2:GOTO3305
3375 PRINT"THE DRAGON BREATHS FIRE!":GOSUB9250
3378 I=RND(ML*20):IFRND(0)<.05*ST(3)THEN3382
3380 PRINT"YOU PARTIALLY DODGE IT":I=INT(I/2+.5)
3382 PRINT"YOU BURN FOR"I"DAMAGE":GOTO3320
3400 D=1:GOTO9386
3700 Q=RND(18):PRINT"EVADE"
3705 IFQ<ST(4)+I(5)THEN3710
3707 PRINT"YOU'RE ROOTED TO THE SPOT":GOSUB9250:GOSUB9246:GOTO3300
3710 IFSF(8)>0THENC=RND(4):GOTO3795
3715 ONRND(4)GOTO3720,3730,3740,3750
3720 C=1:IF(LAND3)<3THEN3795
3730 C=2:IF(P(2,1)AND3)<3THEN3795
3740 C=3:IF(INT(L/4)AND3)<3THEN3795
3750 C=4:IF(INT(P(1,2)/4)AND3)<3THEN3795
3760 C=1:IF(LAND3)<3THEN3795
3770 C=2:IF(P(2,1)AND3)<3THEN3795
3780 C=3:IF(INT(L/4)AND3)<3THEN3795
3790 GOTO3707
3795 GOSUB9348:GOSUB9248:GOTO8120
3900 IFRND(0)>.5THEN4002
4000 IFRND(0)>.2THEN6000
4002 T=0:IFRND(0)>.85THENT=1
4005 PRINT@135,"$";:GOSUB9246:C=0:IFRND(0)>.7THEN4100
4007 PRINT"YOU SEE SOME ";:I=RND(5)-1
4010 PRINTMID$(T$,I*6+1,6):PRINT"enter TO PICK UP:";
4011 IFT=1THENIFSF(2)>0ANDRND(0)>.1THENPRINT:PRINT"YOU DETECT TRAPS!";
4012 GOSUB9240:IFC$=CHR$(13)THEN4020
4015 PRINT"LEAVE IT":GOSUB9250:GOTO6000
4020 PRINT"SNARF IT":IFT=0THEN4040
4025 Q=RND(L*3):GOSUB9248
4030 PRINT"IT'S TRAPPED!":PRINT"YOU SUFFER"Q"DAMAGE"
4035 CH=CH-Q:GOSUB9318:IFCH<1THENGOSUB20:GOTO9000
4040 J=INT(RND(0)*I*L*200+1):PRINT"IT'S WORTH"J"GOLD"
4045 GD=GD+J:IFI=0ANDRND(0)>.8THENGOSUB9320:GOSUB9248:GOTO4200
4050 GOSUB9320:GOTO4900
4100 IFRND(0)>.5THEN4200
4105 PRINT"YOU HAVE FOUND A TREASURE CHEST!"
4110 PRINT"enter TO OPEN IT:";
4115 IFT=1THENIFSF(2)>0ANDRND(0)>.1THENPRINT:PRINT"YOU DETECT TRAPS!";
4120 GOSUB9240:IFC$<>CHR$(13)THENPRINT"IGNORE IT":GOTO6000
4125 PRINT"OPEN IT":IFT=0THEN4140
4130 GOSUB9250:PRINT"CHEST EXPLODES!":I=RND(10*CZ):CH=CH-I
4135 PRINT"YOU SUFFER"I"DAMAGE":GOSUB9318:IFCH<1THEN9000
4140 GOSUB9250:I=INT(RND(0)*(1000*LV^2)+1)
4145 IFRND(0)>.9THENPRINT"INSIDE, THERE ARE ONLY COBWEBS...":GOTO4900
4150 PRINT"INSIDE IS"I"GOLD PIECES!":GD=GD+I:GOSUB9320:IFRND(0)>.5THEN4900
4155 C=1:GOSUB9250
4200 I=RND(10):PRINT"YOU SEE A ";
4205 J=INT(RND(0)^.5*(L+1)+1):IFI>7THENPRINTI$(I):GOTO4215
4210 PRINTI$(I);" +";J
4215 PRINT"enter TO PICK IT UP:";:GOSUB9240:IFC$=CHR$(13)THEN4225
4220 PRINT"LEAVE IT":GOTO4240
4225 IFI<>1ORT<>1THEN4235
4230 PRINT:PRINT"IT'S A HOSTILE SWORD!":I=RND(I*5)
4232 PRINT"YOU SUFFER"I"DAMAGE":CH=CH-I:GOSUB9320:IFCH<1THEN9000
4234 GOTO4900
4235 PRINT"IT'S YOURS!":I(I)=I(I)+1:IFI<8THENI(I)=J
4237 GOSUB9320
4240 IFC=1ANDRND(0)>.5THENGOSUB9250:GOTO4200
4900 PRINT@135," ";:GOSUB9250
4910 IFRND(1)>.5THENGOSUB9690:IFM<>0THEN3010
6000 X=CX:Y=CY:Z=CZ-1:GOSUB9100
6002 J=INT(H/256):I=INT(L/256)
6005 IFCZ=1THENJ=0
6010 IFI>9THENI=I-9:GOTO6010
6012 IFJ>9THENJ=J-9:GOTO6012
6013 IFCZ=50ANDI=4THENI=0
6014 IFI=0ANDJ<>4THEN8000
6015 IFJ=4THEN6500
6020 ONIGOTO6100,6300,6400,6500,6600,6700,6800,6900,7100
6100 IFCZ<>1THEN6200
6101 J=4:GOTO6500
6102 Q1=CX*CY:Q2=CX+CY:Q3=CX*3+CY*7:Q1=Q1-INT(Q1/10)*10+1:Q2=Q2-INT(Q2/10)*10+1
6103 Q3=Q3-INT(Q3/10)*10+1:M$=IN$(Q1,1)+" "+IN$(Q2,2)+" "+IN$(Q3,3)+" "
6104 GOSUB9248:GOSUB10:FORQ=205TO214:CC=Q:GOSUB9:CC=Q+192:GOSUB9
6105 NEXT:CC=333:GOSUB9:CC=334:GOSUB9:CC=341:GOSUB9:CC=342:GOSUB9:CC=269:GOSUB9:CC=270:GOSUB9:CC=277:GOSUB9:CC=278:GOSUB9
6106 CC=141:GOSUB9:CC=142:GOSUB9:CC=143:GOSUB9:CC=144:GOSUB9:CC=80:GOSUB9
6107 CC=81:GOSUB9:CC=82:GOSUB9:CC=83:GOSUB9:CC=147:GOSUB9:CC=148:GOSUB9:CC=149:GOSUB9:CC=150:GOSUB9:PRINT@167,"X";
6108 PRINT@225,IN$(Q1,1):PRINT@257,IN$(Q2,2):PRINT@290,IN$(Q3,3)
6110 PRINT@135,"INN";:GOSUB9246:PRINT"YOU HAVE FOUND THE ";M$
6111 PRINT"THEY CASH IN YOUR GOLD":EX=EX+GD:TG=TG+GD:GD=0:GOSUB9320
6115 GOSUB9252:GOSUB9710:GOSUB9248:CH=HP:PRINT"YOU HAVE"TG"IN THE SAFE"
6116 FORI=0TO11:SF(I)=0:NEXT
6119 CS=SU:PRINT"YOU SPEND THE NIGHT":GOSUB20
6120 PRINT"YOU FEEL BETTER":GOSUB9320:GOSUB9248
6125 PRINT"enter TO RETURN TO DUNGEON,"
6130 PRINT"* TO SAVE CHARACTER ON CASSETTE:";
6135 GOSUB9240:IFC$="@"THEN6135
6140 IFC$=CHR$(31)ANDNM$<>"DEMO"THENPRINT:GOTO8600
6142 IFC$<>CHR$(13)THENPRINT"???";:GOSUB9250:GOTO6125
6145 PRINT"REENTER";:GOSUB9250:CZ=1:GOTO2000
6200 PRINT@135,"ELV";:GOSUB9246:PRINT"YOU FEEL HEAVY FOR A MOMENT"
6210 GOSUB20:CZ=CZ-1:GOTO2000
6300 IFCZ=50THEN6200
6302 PRINT@135,"PIT";:GOSUB9246:PRINT"YOU SEE A PIT"
6303 IFSF(5)>0THENPRINT"YOU ARE HOVERING ABOVE A PIT":GOTO6310
6305 IFRND(20)-1>ST(4)+I(5)THEN6330
6310 PRINT"DO YOU WANT TO DESCEND?";:GOSUB9240:IFC$="Y"THEN6320
6315 PRINT"NO":GOSUB9250:GOTO8000
6320 PRINT"YES":GOTO6335
6330 PRINT"YOU FALL IN!":L=3:GOSUB9290:GOSUB20
6335 CZ=CZ+1:GOTO2000
6400 PRINT@135,"TPT";:GOSUB9246
6403 PRINT"ZZAP! YOU'VE BEEN TELEPORTED...":GOSUB9320
6405 IF((CX+CY)AND1)=0THENCZ=CZ-1:IF((CX+CY)AND2)=2THENCZ=CZ+2
6410 CX=CZ*8+CY*13:CY=CY+CZ*6+CX*17
6415 IFCX>200THENCX=CX-200:GOTO6415
6420 IFCY>200THENCY=CY-200:GOTO6420
6425 IFCZ=0THENCZ=1
6430 IFCZ>50THENCZ=50
6435 IFRND(0)>.8THEN6405
6440 GOTO2000
6500 PRINT@135,;:IFJ=4THENPRINT"^";
6505 IFI=4THENPRINTCHR$(92);
6510 GOSUB9248:PRINT"YOU HAVE FOUND A CIRCULAR STAIRWAY"
6512 IFJ=4ANDCZ=1THENPRINT"YOU SEE LIGHT ABOVE"
6515 PRINT"DO YOU WANT TO ";
6520 IFJ=4THENPRINT"GO UP, ";
6525 IFI=4THENPRINT"GO DOWN, ";
6530 PRINT:PRINT"OR STAY ON THE SAME LEVEL?";:GOSUB9240
6532 IFC$="@"THENC$="S"
6535 IF(I<>4AND(C$="D"ORC$="1"))OR(J<>4AND(C$="U"ORC$="7"))THEN6550
6540 IFC$="U"ORC$="7"THENPRINT"UP";:CZ=CZ-1:IFCZ>0THEN2000
6542 IFCZ<=0THEN6102
6545 IFC$="D"ORC$="1"THENPRINT"DOWN";:CZ=CZ+1:GOTO2000
6547 IFC$="S"ORC$="5"THENPRINT"STAY";:GOSUB9248:GOTO8000
6550 PRINT"???";:GOTO6510
6600 PRINT@135,"ALT";:GOSUB9248:PRINT"YOU HAVE FOUND A HOLY ALTAR"
6605 PRINT"enter TO WORSHIP";:GOSUB9240:IFC$=CHR$(13)THEN6630
6610 IFRND(0)>.7THEN8000
6615 PRINT:PRINT"DIRTY PAGAN TRASH!":PRINT@135,"#  ";
6620 M=INT(RND(0)*20+1):GOSUB9352:IFUN=0THEN6620
6625 GOSUB9250:GOTO3007
6630 PRINT:PRINT"enter TO DONATE";:GOSUB9240
6632 IFC$<>CHR$(13)THEN6610
6634 PRINT:PRINT"HOW MUCH GOLD?";:GOSUB9356:GOSUB9248
6636 IFC>GDTHENPRINT"YOU DON'T HAVE THAT MUCH!";:GOTO6615
6640 IFC<50*CZTHENPRINT@416,;:GOTO6615
6645 GD=GD-C:GOSUB9320
6650 IFRND(0)<C/(GD+C)THEN6660
6655 PRINT"THANK YOU FOR YOUR DONATION":GOSUB9250:GOTO8000
6660 I=RND(7):IFSF(I)<0THENSF(I)=0
6665 SF(I)=SF(I)+INT(RND(0)*100*C/(GD+C)+1)
6680 PRINT"YOU'VE BEEN HEARD":GOSUB9250:GOTO8000
6700 PRINT@135,"FNT";:GOSUB9248:PRINT"YOU HAVE FOUND A FOUNTAIN"
6701 C=RND(5)
6702 PRINT"WITH RUNNING ";MID$("WHITEBLACKGREENCLEARRED",C*5-4,5);" WATER"
6705 PRINT"enter TO DRINK SOME:";:GOSUB9240:IFC$=CHR$(13)THEN6715
6710 GOSUB9248:GOTO8000
6715 GOSUB9248:IFRND(0)>.6THEN6750
6717 IFRND(0)>1-C*.15THEN6730
6720 PRINT"YOU FEEL BETTER":GOSUB20:I=RND(3*CZ)
6725 PRINT"YOU HEAL"I"HP":CH=CH+I:IFCH>HPTHENCH=HP
6727 GOSUB9318:GOSUB9250:GOTO8000
6730 IFRND(0)>.15*CTHEN6745
6735 PRINT"IT'S POISON!":I=RND(3*CZ):PRINT"YOU LOSE"I"HP"
6740 CH=CH-I:GOSUB9318:IFCH<1THEN9000
6742 GOSUB9250:GOTO8000
6745 GOSUB9296:GOSUB9320:GOSUB9250:GOTO8000
6750 IFRND(0)>.4THENPRINT"YOU FEEL REFRESHED!":GOSUB9250:GOTO8000
6752 IFRND(0)>.5THEN6780
6755 IFRND(1)>.5THEN6770
6760 PRINT"MAGICAL POWER SURGES THROUGH YOUR BODY":CS=CS+RND(4*CZ)
6765 PRINT"YOU NOW HAVE"CS"SPELLS":GOSUB9316:GOSUB9250:GOTO8000
6770 PRINT"YOU HAVE BEEN DISPOSESSED!":FORI=1TO10:I(I)=0:NEXT:GOSUB20
6775 GOSUB9250:CLS:GOSUB9320:GOSUB9122:GOSUB9698:GOTO8000
6780 PRINT"YOU FEEL REFRESHED!":GOSUB9250:PRINT"ACTUALLY YOU'RE DRUNK!"
6785 IFSF(11)<0THENSF(11)=0
6786 SF(11)=SF(11)+RND(16):GOSUB9122:GOSUB9248:GOTO8000
6800 PRINT@135,"GCB";:GOSUB9248:PRINT"YOU SEE A LARGE GRAY MISTY CUBE"
6805 PRINT"enter TO WALK IN:";:GOSUB9240:IFCHR$(13)<>C$THEN8000
6810 IFRND(0)>.2THEN6815
6812 CZ=RND(50):GOTO6820
6815 PRINT:PRINT"A NUMBER FROM 1 TO 50:";:GOSUB9356:IFC$="@"THEN6812
6817 IFC<1ORC>50THENPRINT"NO YOU FOOL!";:GOSUB9250:GOTO6810
6818 CZ=C
6820 GOSUB10:PRINT@65,"YOU FLOAT";:PRINT@99,"IN SPACE...";:GOTO2000
6900 PRINT@135,"THR";:GOSUB9248:PRINT"YOU SEE A JEWEL ENCRUSTED THRONE"
6905 PRINT"DO YOU WANT TO PRY SOME JEWELS,"
6910 PRINT"SIT DOWN, READ THE RUNES,":PRINT"OR IGNORE IT:";
6915 GOSUB9240:IFC$="I"ORC$="@"THENPRINT"IGNORE":GOSUB9250:GOTO8000
6920 IFC$<>"P"THEN6950
6925 PRINT"PRY":GOSUB9250:IFRND(0)>.7THEN7030
6930 IFRND(0)>.4THEN7025
6935 PRINT"THEY POP INTO YOUR GREEDY HANDS!":I=INT(RND(0)*1000*CZ+1)
6940 PRINT"THEY ARE WORTH"I"GOLD":GD=GD+I:GOSUB9320:GOSUB9250:GOTO8000
6950 IFC$<>"S"THEN6985
6955 PRINT"SIT";:GOSUB9250:IFRND(0)>.7THEN7030
6960 IFRND(0)>.6THEN7025
6965 IFRND(0)>.4THEN6403
6970 PRINT"A LOUD GONG SOUNDS!";:GOSUB9250:IFRND(0)<.5THEN6975
6973 EX=INT(EX/2):IFLV=1THENEX=-1
6974 GOSUB9252:GOTO8000
6975 IFLV>CZTHENPRINT"NOTHING HAPPENS...";:GOTO7010
6980 EX=1000*2^LV:GOSUB9252:GOTO8000
6985 IFC$<>"R"THEN7015
6990 PRINT"READ";:GOSUB9250
6992 IFRND(0)>.7THEN7030
6995 IFRND(0)<ST(1)*.05THEN7005
7000 PRINT:PRINT"YOU DON'T UNDERSTAND THEM...";:GOTO7010
7005 PRINT:PRINT"A MYSTERIOUS MAGIC GRIPS YOU.":GOSUB9304
7010 GOSUB9250:GOTO8000
7015 PRINT"???";:GOSUB9250:GOTO6900
7025 PRINT"NOTHING HAPPENS...";:GOTO7010
7030 M=RND(20):GOSUB9282
7032 PRINT"THE "M$" KING RETURNS!":GOSUB9250:GOSUB9352
7035 PRINT@135,"#  ";:ML=RND(CZ*5)+4:GOTO3010
7100 PRINT@135,"SAF";:GOSUB9248
7105 PRINT"YOU SEE A SMALL BOX WITH FOUR COLORED"
7110 PRINT"LIGHTS. PUSH BUTTONS OR IGNORE:";:GOSUB9240
7115 IFC$<>"P"THENPRINT"IGNORE":GOSUB9250:GOTO8000
7120 PRINT"PUSH":GOSUB9250:CB=1
7125 PRINT"PUSH rED, gREEN, yELLOW, bLUE,":PRINT"OR sTOP:";
7130 GOSUB9240:IFC$="S"ORC$="@"THENPRINT"STOP":GOSUB9250:GOTO8000
7135 FORC=1TO4:IFC$=MID$(B$,C*6-5,1)THENM$=MID$(B$,C*6-5,6)::GOTO7145
7140 NEXT:PRINT"???":GOSUB9250:GOTO7125
7145 GOSUB9284:PRINTM$:IFB(CB)<>CTHEN7170
7150 CB=CB+1:IFCB<5THENGOSUB9250:GOTO7125
7155 PRINT"IT OPENS!  ";:GOSUB9250:PRINT"INSIDE YOU FIND JEWELS WORTH"
7160 GOSUB9288:I=INT(RND(0)*20000*CZ^2+1):PRINTI"GP!":GD=GD+I:GOSUB9320
7165 GOSUB9248:GOTO8000
7170 I=RND(6*CZ):PRINT"AN ELECTRIC BOLT SHOOTS THROUGH YOU!"
7175 GOSUB9250:PRINT"YOU SUFFER"I"POINTS DAMAGE":CH=CH-I:GOSUB9318
7180 IFCH<1THEN9000
7185 GOSUB9250:GOTO8000
8000 M=0:GOSUB9248:GOSUB9246:PRINT"->";
8020 GOSUB9240:IFC$="@"THENC$="S"
8100 Q=1:FORC=QTO20:ON-(MID$(CM$,C,Q)=C$)GOTO8117:NEXT
8115 PRINT@352,"NO";:FORI=1TO200:NEXT:GOTO8000
8117 IFC>5THENC=C-5
8118 IFSF(11)>0ANDC<6THENPRINT"YOU'RE CONFUSED ->";:C=RND(5)
8120 ONCGOTO8150,8200,8250,8300,8350,8800,8700,8900,8970,8970,8600,8910,8925,8945
8150 IF(LAND3)>2ANDSF(8)<1ORCY=1THEN8115
8155 PRINT"NORTH";:CY=CY-1:GOSUB9704:GOTO2000
8200 IF(P(2,1)AND3)>2ANDSF(8)<1ORCY=200THEN8115
8205 PRINT"SOUTH";:CY=CY+1:GOSUB9704:GOTO2000
8250 IF(INT(L/4)AND3)>2ANDSF(8)<1ORCX=1THEN8115
8255 PRINT"WEST";:CX=CX-1:GOSUB9704:GOTO2000
8300 IF(INT(P(1,2)/4)AND3)>2ANDSF(8)<1ORCX=200THEN8115
8305 PRINT"EAST";:CX=CX+1:GOSUB9704:GOTO2000
8350 PRINT"STAY";:PRINT@135,"   ";:GOSUB9690:IFM<>0THEN3010
8355 SY=0:GOTO2000
8600 PRINT"STORE ";NM$;
8615 END
8670 GOSUB9250:IFCZ=0THEN6125
8675 GOTO8000
8700 PRINT"QUIT":END
8800 CLS:PRINT"COMMANDS ARE:":PRINT
8850 PRINT:PRINT"PRESS ANY KEY";:GOSUB9240:GOSUB9250:CLS:GOSUB9320:GOSUB9122:GOSUB9698:GOTO8000
8900 PRINT"RE-PLOT":GOSUB20:CLS:GOSUB9320:GOSUB9122:GOSUB9698:GOTO8000
8910 PRINT"USE SCROLL OF RESCUE"
8915 IFI(8)<1THEN8920
8917 I(8)=I(8)-1:CX=25:CY=13:CZ=1:PRINT"*ZAP!*":GOSUB20:GOSUB9698
8918 GD=0:GOSUB9320:GOTO2000
8920 PRINT"YOU DON'T HAVE ONE!"
8922 GOSUB9250:GOTO8000
8925 PRINT"DRINK HEALING POTION":IFI(9)<1THEN8920
8935 I(9)=I(9)-1:GOSUB9320:CH=CH+RND(20):IFCH>HPTHENCH=HP
8940 PRINT"YOU FEEL BETTER!":GOSUB9320:GOTO8922
8945 PRINT"DRINK GIANT STRENGTH POTION":IFI(10)<1THEN8920
8950 IFSF(1)<0THENSF(1)=0
8955 SF(1)=SF(1)+19+RND(20):PRINT"STRENGTH FLOWS THROUGH YOUR BODY"
8960 I(10)=I(10)-1:GOSUB9320:GOTO8922
8970 D=0:GOTO9386
9000 GOSUB9248:PRINT"YOU DIED!":GOSUB9250
9001 IFSF(10)>0THEN9656
9002 CLS:PRINT@96,"ANOTHER ";:IFLV<4THENPRINT"NOT SO ";
9005 PRINT"MIGHTY ADVENTURER":PRINT"BITES THE DUST"
9010 PRINT@256,"TRY AGAIN?";
9012 GOSUB9240:IFC$="N"ORC$="9"THEN9020
9013 IFC$="@"THEN9012
9015 PRINT"YES":RUN
9020 END
9100 Q=X*XO+Y*YO+Z*ZO+(X+XO)*(Y+YO)*(Z+ZO)
9102 H=(Q-INT(Q))*WO:IFINT(H/256)>5THENH=HAND255
9104 IFINT(H/256)>0THENH=(INT((Q*10-INT(Q*10))*15+1)*256)OR(HAND255)
9106 IFX=1ORX=201THENH=HOR12
9108 IFY=1ORY=201THENH=HOR3
9110 RETURN
9112 IFW<2THENRETURN
9114 FORQ=3TO7:CC=L+Q:GOSUB9:NEXT:RETURN
9116 IFW<2THENRETURN
9118 FORQ=0TO192STEP64:CC=L+Q:GOSUB9:CC=L+Q+1:GOSUB9:NEXT:IFW>2THENRETURN
9120 CC=L+65:GOSUB9:CC=L+64:GOSUB9:CC=L+129:GOSUB9:CC=L+128:GOSUB9:RETURN
9122 Z=CZ:FORQ2=0TO3:Y=CY+Q2-1:FORQ1=0TO3:X=CX+Q1-1:GOSUB9100
9124 P(Q2,Q1)=H:NEXT:NEXT
9126 GOSUB10:NEXT:PRINT@320,;
9128 Q=0:FORI=1TO11
9130 IFSF(I)<1THEN9136
9132 ON-(POS(0)<27)GOTO9134:Q=1:PRINT@288,;
9134 PRINTMID$("STRGDTRPLGHTPROTLEVTINVSFEARASTWTMSTRSEDDRNK",I*4-3,4);":";
9136 NEXT:IF(P(1,1)AND3)>1OR(INT(P(0,1)/4)AND3)>1THEN9140
9138 L=2:W=(P(0,0)AND3):GOSUB9112
9140 IF(P(1,0)AND3)>1OR((INT(P(1,1))/4)AND3)>1THEN9144
9142 L=2:W=(INT(P(0,0)/4)AND3):GOSUB9116
9144 IF(P(1,1)AND3)>1THEN9150
9146 L=12:W=(P(0,1)AND3):GOSUB9112:W=(INT(P(0,1)/4)AND3):GOSUB9116
9148 L=22:W=(INT(P(0,2)/4)AND3):GOSUB9116
9150 IF(P(1,1)AND3)>1OR(INT(P(0,2)/4)AND3)>1THEN9154
9152 L=22:W=P(0,2)AND3:GOSUB9112
9154 IF(INT(P(1,2)/4)AND3)>1OR(P(1,2)AND3)>1THEN9158
9156 L=32:W=INT(P(0,3)/4)AND3:GOSUB9116
9158 IF(INT(P(1,2)/4)AND3)>1THEN9164
9160 L=214:W=(P(1,2)AND3):GOSUB9112:L=224:W=INT(P(1,3)/4)AND3:GOSUB9116
9162 L=406:W=P(2,2)AND3:GOSUB9112
9164 IF(P(2,1)AND3)>1OR(INT(P(2,2)/4)AND3)>1THEN9168
9166 L=598:W=P(3,2)AND3:GOSUB9112
9168 IF(INT(P(1,2)/4)AND3)>1OR(P(2,2)AND3)>1THEN9172
9170 L=416:W=(INT(P(2,3)/4)AND3):GOSUB9116
9172 IF(P(2,1)AND3)>1THEN9178
9174 L=406:W=INT(P(2,2)/4)AND3:GOSUB9116
9176 L=588:W=P(3,1)AND3:GOSUB9112:L=396:W=INT(P(2,1)/4)AND3:GOSUB9116
9178 IF(P(2,1)AND3)>1OR(INT(P(2,1)/4)AND3)>1THEN9182
9180 L=578:W=P(3,0)AND3:GOSUB9112
9182 IF(INT(P(1,1)/4)AND3)>1OR(P(2,0)AND3)>1THEN9186
9184 L=386:W=INT(P(2,0)/4)AND3:GOSUB9116
9186 IF(INT(P(1,1)/4)AND3)>1THEN9192
9188 L=386:W=P(2,0)AND3:GOSUB9112
9190 L=194:W=INT(P(1,0)/4)AND3:GOSUB9116:W=P(1,0)AND3:GOSUB9112
9192 L=204:W=INT(P(1,1)/4)AND3:GOSUB9116:W=P(1,1)AND3:GOSUB9112
9194 L=214:W=INT(P(1,2)/4)AND3:GOSUB9116:L=396:W=P(2,1)AND3:GOSUB9112
9196 CC=337:GOSUB9:L=P(1,1):IFSF(3)<=0THENRETURN
9198 IFINT(P(0,0)/256)=0THEN9206
9200 IF(P(1,0)AND3)<AAND(INT(P(1,1)/4)AND3)<2THEN9204
9202 IF(P(1,1)AND3)>1OR(INT(P(0,1)/4)AND3)>1THEN9206
9204 CC=135:GOSUB9
9206 IFINT(P(0,1)/256)<>0AND(P(1,1)AND3)<2THENCC=145:GOSUB9
9208 IFINT(P(0,2)/256)=0THEN9216
9210 IF(P(1,1)AND3)<2AND(INT(P(0,2)/4)AND3)<2THEN9214
9212 IF(P(1,2)AND3)>1OR(INT(P(1,2)/4)AND3)>1THEN9216
9214 CC=155:GOSUB9
9216 IFINT(P(1,2)/256)<>0AND(INT(P(1,2)/4)AND3)<2THENCC=347:GOSUB9
9218 IFINT(P(2,2)/256)=0THEN9226
9220 IF(P(2,2)AND3)<2AND(INT(P(1,2)/4)AND3)<2THEN9224
9222 IF(P(2,1)AND3)>1OR(INT(P(2,2)/4)AND3)>1THEN9226
9224 CC=539:GOSUB9
9226 IFINT(P(2,1)/256)<>0AND(P(2,1)AND3)<2THENCC=529:GOSUB9
9228 IFINT(P(2,0)/256)=0THEN9236
9230 IF(P(2,0)AND3)<2AND(INT(P(1,1)/4)AND3)<2THEN9234
9232 IF(P(2,1)AND3)>1OR(INT(P(2,1)/4)AND3)>1THEN9236
9234 CC=519:GOSUB9
9236 IFINT(P(1,0)/256)<>0AND(INT(P(1,1)/4)AND3)<2THENCC=327:GOSUB9
9238 RETURN
9240 FORQ=1TO300:C$=INKEY$:IFC$<>""THENRETURN
9242 NEXT:IFNM$="DEMO"THEN9240
9244 C$="@":RETURN
9246 PRINT@352,;:RETURN
9248 FORQQ=0TO128STEP32:PRINT@352+QQ,"                               ";:NEXT:GOSUB9246:RETURN
9250 GOSUB20:GOTO9248
9252 IFEX<1000*2^LVTHEN9262
9254 GOSUB9248:PRINT"YOU WENT UP A LEVEL!";:LV=LV+1:J=RND(ST(3))
9256 CH=CH+J:HP=HP+J:IFEX>1000*2^LVTHENEX=1000*2^LV-1
9258 CS=CS+LV:SU=SU+LV
9260 GOSUB9320:GOSUB9250:PRINT"YOU GAIN";J;"HIT POINTS":RETURN
9262 IFLV=1ANDEX>=0THENRETURN
9264 IFEX>1000*2^(LV-1)THENRETURN
9266 CS=CS-LV:SU=SU-LV:IFCS<0THENCS=0
9268 PRINT"YOU GO DOWN A LEVEL!";:LV=LV-1:J=RND(ST(3))
9270 CH=CH-J:HP=HP-J
9272 GOSUB9320:GOSUB9250:PRINT"YOU LOSE";J;"HIT POINTS"
9274 IFCH>0ANDLV>0THENRETURN
9276 GOSUB20:GOTO9000
9280 FORQ=1TO100:NEXT:RETURN
9282 M$=MID$(MO$,M*8-7,8)
9284 IFRIGHT$(M$,1)=" "THENM$=LEFT$(M$,LEN(M$)-1):GOTO9284
9286 RETURN
9288 FORQ=1TO4:B(Q)=RND(4):NEXT:RETURN
9290 D=INT(RND(0)*L*6+1):PRINT"YOU SUFFER"D"HIT POINTS":CH=CH-D
9292 IFCH>0THENGOSUB9318:RETURN
9294 PRINT"YOUR LIFE HAS BEEN TERMINATED":GOSUB9320:GOSUB9250:GOTO9000
9296 I=INT(RND(0)*500*CZ+1):PRINT"YOU JUST ";
9298 IFRND(0)>.5THENPRINT"LOST";:I=-I:GOTO9302
9300 PRINT"GAINED";
9302 PRINTABS(I);"EXPERIENCE POINTS":EX=EX+I:GOSUB9252:RETURN
9304 I=RND(6)-1:IFRND(0)>.5THEN9310
9306 IFST(I)=18THEN9304
9308 PRINT"YOUR ";MID$(S$,I*3+1,3);" GOES UP";:ST(I)=ST(I)+1:GOTO9314
9310 IFST(I)=3THEN9304
9312 PRINT"YOUR ";MID$(S$,I*3+1,3);" GOES DOWN";:ST(I)=ST(I)-1
9314 PRINT" BY 1":GOSUB9320:GOSUB20:RETURN
9316 K=PEEK(16417):K1=PEEK(16416):EN=2:GOTO20320
9318 K=PEEK(16417):K1=PEEK(16416):EN=3:GOTO20320
9320 K=PEEK(16417):K1=PEEK(16416):EN=1
9322 IFEN=3THENRETURN
9324 IFEN=2THENRETURN
9326 REM
9328 QQ=0:FORI=1TO10:IFI<4THENIFI(I)>=0THEN9332
9330 IFI(I)<1THEN9340
9332 QQ=QQ+1:PRINT@QQ*32-8,;:IFI>7THEN9338
9334 PRINTRIGHT$(I$(I),8);:IFI(I)>0THENPRINT" +";MID$(STR$(I(I)),2);"   ";:GOTO9340
9336 PRINT"     ";:GOTO9340
9338 PRINTSTR$(I(I));" ";RIGHT(I$(I),8);
9340 NEXT
9342 PRINT@QQ*32+24,"        ";:RETURN
9348 PRINT@336,"         "
9350 GOSUB9248:PRINT@135," ";:RETURN
9352 UN=0:IFM=3ORM=5ORM=8ORM=10ORM=13ORM=17ORM=18THENUN=1
9354 RETURN
9356 D$=""
9358 GOSUB9240:IFC$<>CHR$(20)THEN9366
9360 IFD$=""THEN9358
9362 PRINT"20815";:IFLEN(D$)=1THEN9356
9364 D$=LEFT$(D$,LEN(D$)-1):GOTO9358
9366 IFC$=CHR$(13)THENC=VAL(D$):PRINT:RETURN
9368 IFC$=""THENC=0:RETURN
9370 IFLEN(D$)>9THEN9358
9372 IFC$="-"ANDD$=""THEN9376
9374 IFC$<"0"ORC$>"9"THEN9358
9376 PRINTC$;:D$=D$+C$:GOTO9358
9378 GOSUB9246:PRINT"YOU HAVE NOT BEEN NOTICED..."
9380 PRINT"enter TO APPROACH:";:GOSUB9240
9382 IFC$=CHR$(13)THENGOSUB9248:GOTO3007
9384 PRINT@135," ";:GOSUB9248:GOTO4000
9386 PRINT"CAST":PRINT"SPELL LEVEL:";:GOSUB9240:C=VAL(C$):PRINTC$
9388 IFC>0ANDC<=INT(LV/3)+1ANDC<7THEN9394
9390 IFC=0THEN9428
9392 PRINT"SPELL LEVEL NOT HIGH ENOUGH!":GOSUB20:GOTO9428
9394 IFC>CSTHENPRINT"NOT ENOUGH SPELL UNITS!":GOTO9424
9396 PRINT"SPELL( = TO LIST):";:GOSUB9240:IFC$=CHR$(13)ORC$="@"THEN9428
9398 IFC$<"1"ORC$>"6"THENC$="="
9400 IFC$="="THEN9404
9402 CS=CS-C:GOSUB9316:GOTO9414
9404 GOSUB9248:FORI=1TO3:PRINTI;LEFT$(P$(I+6*(C-1)),20);
9406 PRINTTAB(20);I+3;LEFT$(P$(I+3+6*(C-1)),19):NEXT
9408 PRINT"HIT ANY KEY";:GOSUB9240:GOSUB9248
9410 IFC$<"1"ORC$>"6"THEN9396
9412 GOTO9402
9414 S=VAL(C$):ONCGOTO9436,9482,9516,9552,9596,9650
9416 MH=MH-I:PRINT"IT SUFFERS";I;"HIT POINTS":IFMH>0THEN9424
9418 GOTO3220
9420 PRINT"NOT IN MELEE!":GOSUB9250:GOTO3300
9422 PRINT"COMBAT SPELL WASTED!"
9424 GOSUB9250:IFD=1THEN3300
9426 GOTO8000
9428 GOSUB9248:IFD=1THEN3100
9430 GOTO8000
9432 GOSUB9250:GOSUB9348:GOTO4000
9434 PRINT"UNDEAD ARE ALREADY DEAD!":GOTO9424
9436 ONSGOTO9438,9442,9456,9462,9468,9480
9438 PRINTP$(1):GOSUB9250:IFD=0THEN9422
9440 I=RND(8)+4:GOTO9416
9442 PRINTP$(2):GOSUB9250:IFD=0THEN9422
9444 IFUN=1THENPRINT"UNDEAD DON'T SLEEP!":GOTO3300
9446 IFRND(20)>ST(1)THENPRINT"THE ";M$;" ISN'T SLEEPY!":GOTO3300
9448 PRINT"THE ";M$;" IS SLEEPING!":PRINT"enter TO KILL:";:GOSUB9240
9450 IFC$<>CHR$(13)THENGOSUB9248:GOTO3710
9452 IFRND(0)>.2THEN3220
9454 PRINT"IT WOKE UP!":GOSUB20:GOTO3300
9456 PRINTP$(3):I=RND(8):PRINT"YOU FEEL BETTER":CH=CH+I
9458 IFCH>HPTHENCH=HP
9460 GOSUB9318:GOTO9424
9462 S=4:T=3:U=11
9464 PRINTP$(S):IFSF(T)<0THENSF(T)=0
9466 SF(T)=SF(T)+RND(U)+4:GOTO9424
9468 PRINTP$(5):GOSUB9250:IFD=0THEN9422
9470 IFUN=1THEN9474
9472 PRINT"THE ";M$;" IS INSULTED":PRINT"AT BEING CALLED UNDEAD":GOTO9424
9474 IFRND(0)<.05*ST(2)+.05*LV-.05*MLTHEN9478
9476 PRINT"THE ";M$;" LISTENS WITH DEAF EARS":GOTO9424
9478 ML=INT((ML/2)+.5):PRINT"IT RUNS IN FEAR!":GOTO3223
9480 S=6:T=4:U=11:GOTO9464
9482 ONSGOTO9484,9496,9498,9502,9504,9514
9484 PRINTP$(7):GOSUB9250:IFD=0THEN9422
9486 IFINT(RND(0)^2*20+ML)>ST(1)THENPRINT"THE ";M$;" DODGES ASIDE!":GOTO3300
9488 PRINT"THE ";M$;" IS WEBBED!":PRINT"enter TO KILL:";:GOSUB9240
9490 IFC$<>CHR$(13)THENGOSUB9248:GOTO3710
9492 IFRND(0)-ML/20>.2THEN3220
9494 PRINT"IT BROKE FREE!":GOSUB20:GOTO3300
9496 S=8:T=5:U=21:GOTO9464
9498 PRINTP$(9):GOSUB9250:IFD=0THEN9422
9500 I=INT(RND(0)*12+3):GOTO9416
9502 S=10:T=2:U=21:GOTO9464
9504 PRINTP$(11):GOSUB9248:IFD=0THEN9422
9506 IFUN=1THENPRINT"THE UNDEAD IGNORE YOUR WILES!":GOTO3300
9508 IFINT((RND(0)^2)*20+1)>ST(5)THENPRINT"THE ";M$;" RESISTS YOU!":GOTO3300
9510 PRINT"THE ";M$;" IS CHARMED":PRINT"enter TO KILL:";:GOSUB9240
9512 GOTO9490
9514 S=12:T=1:U=21:GOTO9464
9516 ONSGOTO9518,9522,9528,9530,9532,9544
9518 PRINTP$(13):GOSUB9248:PRINT"ZZZZAAAAPP!":IFD=0THEN9422
9520 GOSUB20:I=INT(RND(0)*6*LV+15):GOTO9416
9522 PRINTP$(14):I=INT(RND(0)*24+1):PRINT"YOU FEEL BETTER":CH=CH+I
9524 IFCH>HPTHENCH=HP
9526 GOSUB9318:GOTO9424
9528 S=15:T=3:U=31:GOTO9464
9530 S=16:T=6:U=21:GOTO9464
9532 PRINTP$(17):GOSUB9250:IFD=0THEN9422
9534 IFINT(RND(0)*20+ML)>ST(1)THENPRINT"THE ";M$;" IGNORES YOU!":GOTO3300
9536 PRINT"THE ";M$;" IS HELD":PRINT"enter TO KILL:";:GOSUB9240
9538 IFC$<>CHR$(13)THENGOSUB9248:GOTO3710
9540 IFRND(0)>.2+ML*.03THEN3220
9542 PRINT"IT BROKE FREE!":GOSUB20:GOTO3300
9544 PRINTP$(18):GOSUB9250:IFD=0THEN9422
9546 IFRND(21)+ML<ST(1)THEN9550
9548 PRINT"THE ";M$;" DOESN'T BELIEVE!":GOTO3300
9550 PRINT"IT BELIEVES!....ARRGH...":GOTO3220
9552 ONSGOTO9554,9572,9576,9580,9586,9588
9554 PRINTP$(19):GOSUB9250:IFD=1THEN9420
9556 PRINT"DIRECTION ";:GOSUB9240
9558 FORI=1TO9:IFMID$("WXAD8246@",I,1)=C$THEN9562
9560 NEXT:PRINT"?":GOSUB9248:GOTO9556
9562 IFI>4THENI=I-4
9564 IFI=5THEN9424
9566 IF(I=1ANDCY>1)OR(I=2ANDCY<200)OR(I=3ANDCX>1)OR(I=4ANDCX<200)THEN9570
9568 PRINT"ONLY STONE THERE....":GOTO9424
9570 GOSUB9710:PRINT"*POOF*":ONIGOTO8155,8205,8255,8305
9572 PRINTP$(20):GOSUB9248:PRINT"WHOOOOSHH!":IFD=0THEN9422
9574 PRINT"THE "M$" IS BURNING!":I=INT(RND(0)*12*LV+15):GOSUB20:GOTO9416
9576 PRINTP$(21):GOSUB9250:IFD=0THEN9422
9578 I=INT(RND(0)*32+10):GOTO9416
9580 PRINTP$(22):GOSUB9250:IFD=0THEN9422
9582 IFRND(0)>.6THENPRINT"THE ";M$;" ISN'T AFFECTED":GOTO3300
9584 PRINT"ONE STONE STATUE....":GOTO3220
9586 S=23:T=7:U=30:GOTO9464
9588 PRINTP$(24):GOSUB9250:PRINT"DIE!":IFD=0THEN9422
9590 IFUN=1THEN9434
9592 GOSUB20:IFRND(0)>.3+ML*.4-LV*.03THEN3220
9594 PRINT"THE "M$" LAUGHS":GOSUB9250:GOTO3300
9596 ONSGOTO9598,9616,9618,9624,9628,9638
9598 PRINTP$(25):GOSUB9250:IFD=1THEN9420
9600 PRINT"+NORTH/-SOUTH:";:GOSUB9356:NY=C:PRINT"+EAST/-WEST:";:GOSUB9356
9602 NX=C:PRINT"+UP/-DOWN:";:GOSUB9356:NZ=C:I=SQR(NX^2+NY^2+(NZ*5)^2)-.1
9604 IFI>LV*5THENPRINT"TOO FAR...TRY AGAIN":GOSUB9250:GOTO9600
9606 NX=CX+NX:NY=CY-NY:NZ=CZ-NZ
9608 IFNX>0ANDNX<201ANDNY>0ANDNY<201ANDNZ<51THEN9612
9610 PRINT"ONLY STONE THERE....THE SPELL FAILS":GOTO9424
9612 IFNZ<1THENPRINT"ONLY THIN AIR....THE SPELL FAILS":GOTO9424
9614 CX=NX:CY=NY:CZ=NZ:PRINT"*POOF*":GOSUB9710:GOTO2000
9616 S=26:T=8:U=16:GOTO9464
9618 PRINTP$(27):GOSUB9250:IFD=0THEN9422
9620 PRINT"QWERTY!":GOSUB20:IFRND(0)<.75THEN3220
9622 PRINT"THE ";M$;" DOESN'T HEAR...":GOTO9424
9624 PRINTP$(28):GOSUB9250:IFD=0THEN9422
9626 PRINT"BRRRR!":I=60:GOTO9416
9628 PRINTP$(29):GOSUB9250:PRINT@136,"*";:GOSUB9248:PRINT"WWHHOOOOOSSHHH!"
9630 PRINT"A WALL OF FIRE APPEARS ABOUT YOU":GOSUB20:GOSUB9250
9632 IFD=0THEN9422
9634 PRINT@136," ";:GOSUB9248:IFRND(0)>.4THENPRINT"THE "M$" IS GONE":GOTO9432
9636 PRINT"THE "M$" WALKS THROUGH!":I=RND(12)+7:GOTO9416
9638 PRINTP$(30):GOSUB9250:IFD=0THEN9422
9640 IFUN=1THEN9434
9642 PRINT"BLACK DEATH FOR THE "M$
9644 GOSUB9250:IFRND(0)>ST(2)*.05THENPRINT"IT IS IMMUNE!":GOTO9424
9646 IFRND(0)*2<ST(3)*.03+1THEN3220
9648 PRINT"THE SPELL BACKFIRES!":GOSUB9250:GOTO9000
9650 ONSGOTO9652,9654,9664,9672,9678,9682
9652 S=31:T=9:U=20:GOTO9464
9654 S=32:T=10:U=40:GOTO9464
9656 PRINTP$(32):GOSUB9250:ST(3)=ST(3)-1
9658 SF(10)=0:IFRND(0)>ST(3)*.06THEN9662
9660 PRINT"IT WORKS!":CH=HP:GOSUB9320:GOTO9424
9662 PRINT"IT DOESN'T WORK!":GOTO9000
9664 PRINTP$(33):GOSUB9250:IFD=0THEN9422
9666 FORU=1TO9:PRINT@362,MID$(".,+^O0* ",U,1);:GOSUB9280:NEXT
9668 PRINT@352,;:GOSUB20:IFRND(0)<.9THEN3220
9670 PRINT"THE ";M$;" DOESN'T SEE...":GOTO9424
9672 PRINTP$(34):GOSUB9250:IFD=1THEN9420
9674 FORI=0TO10:I(I)=0:NEXT:GD=0:CLS:GOSUB9320:GOSUB9710
9676 CX=25:CY=13:CZ=1:PRINT@131,"*ZAP!*":GOSUB20:GOTO2000
9678 PRINTP$(35):GOSUB9250:PRINT"YOU FEEL BETTER":CH=HP:GOSUB9318
9680 GOTO9424
9682 PRINTP$(36):GOSUB9250:PRINT"A SHIFTING MULTI-COLORED WALL APPEARS!"
9684 IFD=0THEN9422
9686 FORJ=1TO16:PRINT@168,"*";:GOSUB9280:PRINT@168," ";:GOSUB9280:NEXT
9688 PRINT@167,"X";:PRINT@136," ";:GOSUB9248:PRINT"THE "M$" IS GONE":GOTO9432
9690 M=0:IFFM(1)=0THEN9694
9692 M=FM(1):ML=FL(1):MH=FH(1):GOSUB9352
9694 FORI=1TO19:FM(I)=FM(I+1):FL(I)=FL(I+1):FH(I)=FH(I+1):NEXT
9696 FM(20)=0:FL(20)=0:FH(20)=0:IFM<>0THENPRINTAT270,"#";
9698 X=-16:FORQ=1TO11:X=X+32:IFFM(Q)=0THENPRINT@X," ";:GOTO9702
9700 PRINT@X,"@";
9702 NEXT:RETURN
9704 FORQ=19TO1STEP-1:FM(Q+1)=FM(Q):FL(Q+1)=FL(Q):FH(Q+1)=FH(Q):NEXT
9706 IFM=0THENFM(1)=0:FL(1)=0:FH(1)=0:GOTO9698
9708 FM(1)=M:FL(1)=ML:FH(1)=MH:GOTO9698
9710 FORQ=1TO20:FM(Q)=0:FL(Q)=0:FH(Q)=0:NEXT:GOTO9698
