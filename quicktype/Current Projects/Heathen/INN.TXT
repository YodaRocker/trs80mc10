5 '** THE INN **7 OPEN"I",#1,"CHAR.DAT":INPUT#1,NAME$,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL:INPUT#1,W$,ARM$,SHI$:CLOSE #18 'CLS:GOTO2010 CLS:FORY=0TO160STEP32:FORX=0TO31:READ P:POKE1024+X+Y,P:NEXTX,Y20 PRINT@108,"inn";CHR$(128);"of";CHR$(128);"the";:PRINT@139,"black";CHR$(128);"trident";30 FORX=192TO418STEP32:PRINT@X,STRING$(31,143);:NEXTX40 PRINT@480,STRING$(31,128);:POKE1024+511,128:PRINT@480,"gold";CHR$(128);"pieces";:POKE1024+491,58:PRINT@503,"hp";:POKE1024+505,5850 LI$="WELCOME TO MY INN, "+NAME$+"!":L=LEN(LI$):PRINT@192+((32-L)/2),LI$;60 GOSUB 18070 PRINT@261,"<1> GET A ROOM"80 PRINT@293,"<2> VISIT BORRIC'S SHOPPE"90 PRINT@325,"<3> RETURN TO THE CAVES":PRINT@357,"<4> QUIT THE GAME"100 PRINT@418,"WHAT IS THY PLEASURE, SIRE?";110 I$=INKEY$:IF I$="" THEN 110120 IF I$="1" THEN GOSUB 300:GOTO 30130 IF I$="2" THEN 490140 IF I$="3" THEN 550150 IF I$="4" THEN 980160 GOTO 110170 GOTO 170180 '** UPDATE STAT LINE **190 'PRINT@480,STRING$(31,128);:POKE1024+511,128200 'PRINT@480,"gold";CHR$(128);"pieces";:POKE1024+491,58210 'PRINT@503,"hp";:POKE1024+505,58220 GP$=STR$(GP):HP$=STR$(HP)230 Y=492240 FOR X=1TOLEN(GP$):POKE1024+Y,ASC(MID$(GP$,X,1)):Y=Y+1:NEXTX250 POKE1024+Y,128260 Y=506270 FORX=1TOLEN(HP$):POKE1024+Y,ASC(MID$(HP$,X,1)):Y=Y+1:NEXTX280 RETURN290 GOTO 290300 '** GET A ROOM **310 GOSUB 600:DAYS=1320 FOR X=192TO418STEP32:PRINT@X,STRING$(31,143);:NEXTX330 PRINT@194,"THE COST IS";3*LVL;"GP PER NIGHT!";340 PRINT@258,"PRESS <SPACE> TO RETURN, OR";:PRINT@292,"ANY OTHER KEY TO REST...";350 I$=INKEY$:IF I$="" THEN 350360 IF I$<>CHR$(32) THEN 400 ELSE RETURN370 DAYS=0:I$=""380 I$=INKEY$390 IF I$=CHR$(32) THEN RETURN400 PRINT@361,"DAYS PASSED:";DAYS410 IF GP<=(3*LVL)-1 THEN 460420 GP=GP-(3*LVL):HP=HP+1:DAYS=DAYS+1430 IF HP>FH THEN HP=FH:GOTO 460440 GOSUB 180450 GOTO 380460 GOSUB180:PRINT@418,"PRESS ANY KEY TO RETURN...";470 I$=INKEY$:IF I$="" THEN 470480 RETURN490 '** VISIT BORRIC'S SHOPPE500 OPEN"O",#1,"CHAR.DAT"510 WRITE#1,NAME$520 WRITE#1,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL530 WRITE#1,W$,ARM$,SHI$:CLOSE#1540 RUN"SHOPPE"550 '** RETURN TO CAVES **560 OPEN"O",#1,"CHAR.DAT"570 WRITE#1,NAME$580 WRITE#1,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL:WRITE#1,W$,ARM$,SHI$:CLOSE#1590 RUN"HEATHEN"600 '** CALCULATE LEVEL **610 IF EX<1500 THEN LVL=1620 IF EX>=1500 AND LVL<2 THEN LVL=2:GOSUB 740630 IF EX>=3000 AND LVL<3 THEN LVL=3:GOSUB740640 IF EX>=6000 AND LVL<4 THEN LVL=4:GOSUB740650 IF EX>=12000 AND LVL<5 THEN LVL=5:GOSUB 740660 IF EX>=25000 AND LVL<6 THEN LVL=6:GOSUB 740670 IF EX>=50000 AND LVL<7 THEN LVL=7:GOSUB 740680 IF EX>=100000 AND LVL<8 THEN LVL=8:GOSUB 740690 IF EX>=200000 AND LVL<9 THEN LVL=9:GOSUB 740700 IF EX>=300000 AND LVL<10 THEN LVL=10:GOSUB 740710 IF EX>=400000 AND LVL<11 THEN LVL=11:GOSUB 740720 IF EX>=500000 AND LVL<12 THEN LVL=12:GOSUB 740730 RETURN740 '** ADVANCED A LEVEL **750 SOUND 10,1760 FOR X=192TO418STEP32:PRINT@X,STRING$(31,143);:NEXTX770 AH=RND(8)780 IF CO=3 THEN AH=AH-3 ELSE IF (CO>=4 AND CO<=5) THEN AH=AH-2 ELSE IF (CO>=6 AND CO<=8) THEN AH=AH-1 ELSE IF (CO>=13 AND CO<=15) THEN AH=AH+1 ELSE IF (CO>=16 AND CO<=17) THEN AH=AH+2 ELSE IF CO=18 THEN AH=AH+3790 IF AH<1 THEN AH=1800 PRINT@230,"YOU RAISE A LEVEL!!!":PRINT@262,"YOUR HP GOES UP BY";AH:FH=FH+AH810 PRINT@420,"PRESS ANY KEY TO CONTINUE";820 I$=INKEY$:IF I$="" THEN 820830 RETURN840 GOTO 840850 '** BEGIN OF VIEW DATA860 DATA  143, 143, 143, 143, 143, 143, 137, 143, 143, 143, 143, 143, 143, 143, 143, 143870 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 134, 143, 143, 143, 143, 143, 143880 DATA  143, 143, 143, 143, 143, 143, 137, 143, 143, 143, 143, 143, 143, 143, 143, 143890 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 134, 143, 143, 143, 143, 143, 143900 DATA  143, 143, 143, 143, 145, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243910 DATA  243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 146, 143, 143, 143, 143920 DATA  143, 143, 143, 143, 245, 255, 244, 244, 245, 255, 255, 255, 255, 255, 255, 255930 DATA  255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 250, 143, 143, 143, 143940 DATA  143, 143, 143, 143, 245, 255, 255, 245, 255, 255, 255, 255, 255, 255, 255, 255950 DATA  255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 250, 143, 143, 143, 143960 DATA  143, 143, 143, 143, 148, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252970 DATA  252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 252, 152, 143, 143, 143, 143980 '** QUIT THE GAME **990 OPEN"O",#1,"CHAR.DAT"1000 WRITE#1,NAME$1010 WRITE#1,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL:WRITE#1,W$,ARM$,SHI$:CLOSE#11020 KILL NAME$+".DAT":COPY "CHAR.DAT" TO NAME$+".DAT"1030 CLS:END