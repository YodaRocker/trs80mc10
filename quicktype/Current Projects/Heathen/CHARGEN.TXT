4000 CLEAR 20004010 '** CHARACTER GENERATOR **4020 DIM NAME$(30):QQ=1:DIM TEMP$(12)4030 LVL=1:EX=0:W$="NONE":ARM$="NONE":SHI$="NONE"4040 CLS04050 'GOTO 404060 FORX=0TO511:READ P:POKE 1024+X,P:NEXT X4070 PRINT@72,"MAKE THY CHOICE:";:PRINT@103,"----====++====----";:PRINT@164,"1....CREATE NEW CHARACTER";:PRINT@228,"2.....RESUME AN ADVENTURE";4080 PRINT@292,"3..RETURN TO BASIC SAFETY";4090 C=14100 I$=INKEY$4110 GOSUB 45304120 IF I$="1" THEN 41604130 IF I$="2" THEN 46104140 IF I$="3" THEN CLS:END4150 GOTO 41004160 '** MAKE NEW CHARACTER **4170 '**4180 GOSUB 45104190 ST=RND(15)+3:IN=RND(15)+3:WI=RND(15)+3:DE=RND(15)+3:CO=RND(15)+3:CH=RND(15)+34200 HP=RND(8)4210 IF CO=3 THEN HP=HP-3 ELSE IF (CO>=4 AND CO<=5) THEN HP=HP-2 ELSE IF (CO>=6 AND CO<=8) THEN HP=HP-1 ELSE IF (CO>=13 AND CO<=15) THEN HP=HP+1 ELSE IF (CO>=16 AND CO<=17) THEN HP=HP+2 ELSE IF CO=18 THEN HP=HP+34220 IF HP<1 THEN HP=14230 PRINT@74,"THY ABILITIES";:PRINT@106,"---===+===---";4240 PRINT@168,"STR";ST;:PRINT@200,"INT";IN;:PRINT@232,"WIS";WI;4250 PRINT@178,"DEX";DE;:PRINT@210,"CON";CO;:PRINT@242,"CHR";CH;4260 PRINT@298,"HIT POINTS:";HP;4270 PRINT@357,"<R>E-ROLL OR <C>ONTINUE";4280 I$=INKEY$4290 GOSUB 45304300 IF I$="R" THEN 41904310 IF I$="C" THEN 43304320 GOTO 42804330 GOSUB 45104340 PRINT@68,"THY NAME, WARRIOR?";4350 PRINT@100,STRING$(8,128);4360 NAME$="":LP=1004370 I$=INKEY$:IF I$="" THEN 43704380 IF LP<=107 AND I$<>CHR$(13) AND I$<>CHR$(8) THEN NAME$=NAME$+I$:PRINT@100,NAME$;:LP=LP+14390 IF I$=CHR$(13) THEN 44204400 IF LP>=101 AND I$=CHR$(8) THEN LP=LP-1:TEMP$=LEFT$(NAME$,LEN(NAME$)-1):NAME$=TEMP$:PRINT@100,NAME$;CHR$(128);4410 GOTO 43704420 GP=(RND(30)+5):FH=HP4430 OPEN"O",#1,"CHAR.DAT":WRITE#1,NAME$,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL:WRITE#1,W$,ARM$,SHI$:CLOSE#14440 FL$=NAME$+".DAT":OPEN"O",#1,FL$:WRITE#1,NAME$,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL:WRITE#1,W$,ARM$,SHI$:CLOSE#14450 PRINT@167,"THOU HAST";GP;"GOLD.";4460 PRINT@296,"NOW EQUIP THYSELF";:PRINT@326,"FOR WHAT AWAITS THEE!";4470 I$=INKEY$:GOSUB 45304480 IF I$<>"" THEN 4490 ELSE 44704490 CLS:RUN"SHOPPE.BAS"4500 GOTO 45004510 '** CLEAR SCROLL AREA **4520 FORY=68TO421STEP32:PRINT@Y,STRING$(25,143);:NEXTY:RETURN4530 '** SPINNERS **4540 PRINT@397,"CHOOSE";4550 IF C=1 OR C=5 THEN PRINT@394,"-";:PRINT@405,"-";4560 IF C=2 OR C=6 THEN PRINT@394,CHR$(92);:PRINT@405,CHR$(92);4570 IF C=3 THEN PRINT@394,"I";:PRINT@405,"I";4580 IF C=4 THEN PRINT@394,"/";:PRINT@405,"/";4590 C=C+1:IF C>4 THEN C=14600 RETURN4610 '** RESUME ADVENTURE **4620 GOSUB 50404630 GOSUB 4510:PRINT@68,"RESTORE WHICH CHARACTER?";4640 GOSUB 51904650 NAME$=NAME$+".DAT"4660 KILL"CHAR.DAT"4670 COPY NAME$ TO "CHAR.DAT"4680 CLS:PRINT@203,"LOADING...";:RUN"HEATHEN"4690 END4700 GOTO 47004710 '** BEGIN OF VIEW DATA4720 DATA  241, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 2554730 DATA  255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 248, 159, 155, 2404740 DATA  240, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 2484750 DATA  248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 248, 156, 152, 2404760 DATA  240, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434770 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 128, 2404780 DATA  240, 133, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434790 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 138, 2404800 DATA  240, 128, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434810 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 138, 2404820 DATA  240, 128, 133, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434830 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 138, 2404840 DATA  240, 240, 133, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434850 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 2404860 DATA  240, 240, 133, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434870 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 2404880 DATA  240, 240, 133, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434890 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1384900 DATA  240, 240, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434910 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 2404920 DATA  240, 240, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434930 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 2404940 DATA  240, 240, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434950 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 2404960 DATA  240, 240, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434970 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 138, 2404980 DATA  240, 133, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 1434990 DATA  143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 143, 138, 2405000 DATA  240, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 2435010 DATA  243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 243, 242, 147, 146, 2405020 DATA  244, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 2545030 DATA  254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 254, 242, 159, 158, 2405040 '** READ DIRECTORY **5050 TRACK=175060 FOR S=3 TO 115070 DSKI$F,17,S,A$,B$5080 A$=A$+LEFT$(B$,127)5090 FOR P=1 TO 255 STEP 325100 NAME$=MID$(A$,P,8)5110 EXT$=MID$(A$,P+8,3)5120 IF EXT$<>"   "THEN EXT$="."+EXT$:NAME$=NAME$+EXT$5130 IF LEFT$(NAME$,1)=CHR$(255) THEN 51805140 IF LEFT$(NAME$,1)=CHR$(0)THEN 51605150 NAME$(QQ)=NAME$:QQ=QQ+15160 NEXT P5170 NEXT S5180 RETURN5190 '** DISPLAY .DAT FILES **5200 LC=132:COUNTER=0:CI=15210 I$=INKEY$5220 FOR X=1 TO QQ5230 IF RIGHT$(NAME$(X),3)="DAT" THEN PRINT@LC,NAME$(X);:LC=LC+32:COUNTER=COUNTER+15240 IF LC=452 THEN LC=1455250 NEXT X5260 LC=1325270 FOR X=0 TO 11:TEMP$(X)=CHR$(PEEK(1024+LC+X)):NEXT X5280 FOR X=0 TO 11:POKE1024+LC+X,ASC(TEMP$(X))-64:NEXT X5290 I$=INKEY$: IF I$="" THEN 52905300 IF I$=CHR$(10) AND CI<COUNTER THEN CI=CI+1:FORX=0TO11:POKE1024+LC+X,ASC(TEMP$(X)):NEXTX:LC=LC+32:IF LC=452 OR LC=465THEN LC=145:GOTO 5270 ELSE 52705310 IF I$=CHR$(94) AND CI<>1 THEN CI=CI-1:FORX=0TO11:POKE1024+LC+X,ASC(TEMP$(X)):NEXTX:LC=LC-32:IF LC<132 THEN LC=132:GOTO5270 ELSE 52705320 IF I$=CHR$(13) THEN 53405330 GOTO 52905340 NAME$=""5350 FOR X=0 TO 75360 IF ASC(TEMP$(X))<>96 THEN NAME$=NAME$+TEMP$(X) ELSE NAME$=NAME$+" "5370 NEXT X5380 RETURN