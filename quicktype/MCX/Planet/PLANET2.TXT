10 REM 80US PLANETARIUM
20 CLEAR100:REM PCLEAR 4 (COCO)
30 CLS:PRINT"80-US PLANETARIUM"
40 DIM PL(9,6),MD(12),SC(9),SZ(9),NM$(9),XY(9,2)
50 FORI=1TO9:FORJ=1TO6:READPL(I,J):NEXTJ:NEXTI
60 DATA 40945,4.0923,.2056,47.146,75.8983,7.0042
70 DATA 40727,1.6021,.0068,75.780,130.1639,3.3944
80 DATA 40587,.98561,.0167,0,101.220,0
90 DATA 40515,.52403,.0934,48.786,334.2183,1.85
100 DATA 38398,.08309,.04845,99.442,12.7167,1.305
110 DATA 31341,.0335,.05565,112.789,91.0833,2.489
120 DATA 39265,.01173,.04724,73.39,169.05,.7731
130 DATA 6499,.005981,.00858,130.68,43.8667,1.773
140 DATA -42756,.003979,.250,109.73,224,17.17
150 INPUT"DATE MM,DD,YYYY";MM,DD,YT:YY=YT-1900
160 INPUT"DAY INCREMENT";DI
170 INPUT"NUMBER OF PLANETS (1-9)";MP
180 FORI=1TO12:READMD(I):NEXTI
190 GOSUB350:YR=1900+YY+DN/365
200 DATA0,31,59,90,120,151,181,212,243,273,304,334
210 JD=15020:DR=3.14159/180
220 FORI=1TO9:READSC(I):NEXTI
230 DATA .6,1.2,1.8,2.5,6,16,35,50,50
240 SC=SC(MP)
250 FORI=1TO9:READSZ(I):NEXTI
260 DATA 3,3,3,3,5,4,3,3,3
270 FORI=0TO9:READNM$(I):NEXTI
280 GOSUB850
290 END
300 REM KEPLER'S EQN
310 M=DR*MU*(T-T0):ACC=.001:E=M
320 E1=M+EC*SIN(E)
330 IF ABS(E1-E)<ACC THEN RETURN
340 E=E1:GOTO320
350 REM JULIAN DAY 
360 GOSUB410
370 T=JD+INT(365.25*YY)+DN
380 RETURN
390 REM DELAY LOOP
400 FORTM=1TO500:NEXTTM:RETURN
410 REM DAY NUMBER IN YEAR
420 DN=MD(MM)+DD
430 IF MM<3 THEN RETURN
440 IF INT(YY/4)*4=YY THEN RETURN
450 IF INT(YY/400)*400=YY THEN470
460 IF INT(YY/100)*100=YY THEN RETURN
470 DN=DN+1
480 RETURN
490 REM SOLVE FOR PLANET COORDS
500 GOSUB300
510 GOSUB690
520 GOSUB750
530 RETURN
540 REM DISPLAY PLANET
550 XX=127+127*(X/SC)
560 YY=191-(95+95*(Y/SC))
570 IF XX<0 OR YY<0 THEN RETURN
580 IF XX>251 OR YY>191 THEN RETURN
590 IF XY(I,1)<>0 THEN GOSUB650
600 XY(I,1)=XX:XY(I,2)=YY
610 CR=SZ(I)
620 CIRCLE(XX,YY),CR,1,1
630 PAINT(XX,YY),1,1
640 RETURN
650 REM BLANK OLD PLANET
660 CIRCLE(XY(I,1),XY(I,2)),SZ(I),0:PAINT(XY(I,1),XY(I,2)),0,0
670 CIRCLE(XY(I,1),XY(I,2)),1,1:LINE(XY(I,1),XY(I,2))-(XX,YY),PSET
680 GOSUB810:RETURN
690 REM RADIUS & ANOMALY
700 A=((3548.19/3600)/(MU))^(.667)
710 X=A*(COS(E)-EC):Y=A*SQR(1-EC^2)*SIN(E)
720 V=ATN(Y/X)
730 R=X/COS(V)
740 RETURN
750 REM XY COORD
760 X=R*(COS(OM)*COS(V+WM)-SIN(OM)*SIN(V+WM)*COS(IN))
770 Y=R*(SIN(OM)*COS(V+wM)+COS(OM)*SIN(V+WM)*COS(IN))
780 RETURN
790 REM SETUP FOR GRAPHICS 
800 PMODE2,1:PCLS:SCREEN1,1:REM PMODE4,1:PCLS:SCREEN1,1 (COCO)
810 REM CENTER MARK 
820 LINE(127,90)-(127,102),PSET
830 LINE(121,96)-(133,96),PSET
840 RETURN
850 REM DISPLAY 
860 IF CD<>0 THEN MP=CD:SC=SC(MP)
870 GOSUB790
880 GOSUB1140 
890 FORI=1TOMP 
900 T0=PL(I,1):MU=PL(I,2) 
910 EC=PL(I,3):OM=PL(I,4)*DR
920 WM=PL(I,5)*DR:IN=PL(I,6)*DR
930 GOSUB490
940 GOSUB540
950 C$=INKEY$:IFC$<>""THENIF ASC(C$)=21 THEN1000 ELSE IF ASC(C$)=13 THEN GOSUB790
960 NEXTI 
970 YR=YR+DI/365:GOSUB1140
980 T=T+DI
990 GOTO890
1000 REM END DISPLAY 
1010 CLS:RETURN 
1020 REM END 
1030 END
1040 DATA"R5;D7;L5;U7"
1050 DATA"BM+3,0;D7"
1060 DATA"R5;D3;L5;D4;R5"
1070 DATA"R5;D4;L2;R2;D3;L5"
1080 DATA"BM+4,0;N;G4;D4;N;R1;N;D3;L4"
1090 DATA"R5;L5;D3;R5;D4;L5"
1100 DATA"D7;R5;U4;L5"
1110 DATA"R5;D7"
1120 DATA"R5;D7;L5;U7;D3;R5"
1130 DATA"R5;D7;U4;L5;U3" 
1140 REM DISPLAY DATE
1150 LINE(185,175)-(255,191),PRESET,BF
1160 MM=INT(12*(YR-INT(YR)))+1
1170 MM$=RIGHT$("00"+MID$(STR$(MM),2),2)
1180 FORK=1TOLEN(MM$):C=VAL(MID$(MM$,K,1))
1190 X1=195+(K-2)*8+1:Y1=180
1200 D$="BM"+STR$(X1)+","+STR$(Y1)+NM$(C):DRAWD$:NEXTK
1210 YR$=MID$(STR$(INT(YR)),2)
1220 FORK=1TOLEN(YR$)
1230 C=VAL(MID$(YR$,K,1))
1240 X1=219+(K-2)*8+1:Y1=180
1250 D$="BM"+STR$(X1)+","+STR$(Y1)+NM$(C)
1260 DRAW D$
1270 NEXTK
1280 RETURN
1300 REM MC-10 EDITS
1310 REM JIM GERRIE
1320 REM CTRL-Q TO QUIT
1330 REM ENTER TO CLEAR SCREEN
