10 'STELLAR EMPIRES GAME PROGRAM20 'BY GRAHAM WILSON30 'MODIFIED FOR THE TRS-8040 'COLOR COMPUTER BY TED50 'AND DREW SHORTER60 'DOWNLOADED FROM FEB 198270 'CHROMASETTE MAGAZINE80 'DISK AND OTHER MODIFICATIONS90 'ADDED BY DONALD BARBER100 'VERSION 2.0110 CLS:RA=RND(-TIMER):CLEAR400:GOSUB140:CLS0:PRINT@128,STRING$(32,255);:PRINT@160,CHR$(255)STRING$(30,159)CHR$(255);:PRINT@192,CHR$(255)CHR$(159);:PRINT@222,CHR$(159)CHR$(255);120 PRINT@224,CHR$(255)CHR$(159);:PRINT@232,"STELLAR EMPIRES";:PRINT@254,CHR$(159)CHR$(255);:PRINT@256,CHR$(255)CHR$(159);:PRINT@286,CHR$(159)CHR$(255);:130 PRINT@286,CHR$(159)CHR$(255);:PRINT@288,CHR$(255)STRING$(30,159)CHR$(255);:PRINT@320,STRING$(32,255);:FORI=1TO1500:NEXT:GOTO160140 Y1=0:Y2=31:X1=8:X2=54150 CLS0:SET(X1,Y1,8):SET(X1,Y2,8):SET(X2,Y1,8):SET(X2,Y2,8):IFY1=23THENRETURNELSEY1=Y1+1:Y2=Y2-1:X1=X1+2:X2=X2-2:GOTO150160 CLS:PRINT:INPUT"HOW MANY PLAYERS (2-4)";X$:NP=VAL(X$):IFNP<2ORNP>4THEN160170 PRINT180 INPUT"FOR HOW LONG DO YOU WANT TO PLAY(IN TURNS)";X$:MT=VAL(X$):IFMT<1THEN180190 NS=7+RND(4+NP)+2*NP:NP=NP-1:T=0:C=RND(3)-1:D=RND(4):DIMS(NS,5+NP),N$(NS),E(NP,1),W(NP,9,2),F$(NP),B(NS,4+NP),M$(NP),D(NS),X(NP,NS)200 PRINT:PRINT"THERE ARE"NS+1"STAR SYSTEMS."210 FORI=0TONS:READN$(I):FORJ=0TONP+5:S(I,J)=0:NEXT:NEXT220 FORI=0TONP:FORJ=0TO9:FORK=0TO2:W(I,J,K)=0:NEXT:NEXT:NEXT230 FORP=0TONP:I=RND(4)+P*4:E(P,0)=I:E(P,1)=0:S(I,0)=4:S(I,3)=P:S(I,4)=5:S(I,5+P)=1240 ONP+1GOSUB250,260,270,280:GOTO290250 X=0:Y=0:RETURN260 Y=7:IFNP=2THENX=3:RETURNELSEX=7:RETURN270 X=7:IFNP=2THENY=1:RETURNELSEY=0:RETURN280 X=0:Y=7:RETURN290 RA=RND(-TIMER):S(I,1)=X+RND(3):S(I,2)=Y+RND(3):CLS:PRINT"PLAYER"P+1300 PRINT"PLAYER NAME = 'C' FOR COMPUTER"310 INPUT"PLEASE ENTER NAME";F$(P):PRINT320 IFF$(P)=""THENPRINT:GOTO310330 IFF$(P)="C"THENCLS:NEXT:GOTO 400340 IFLEN(F$(P))=INT(LEN(F$(P))/2)*2THENF$(P)=F$(P)+" "350 PRINT"PRESS <ENTER> WHEN READY TO     ENTER HOME STAR NAME."360 INPUT"OTHER PLAYERS MAY NOT WATCH!";X$:CLS370 PRINT380 PRINT"THE REGULAR NAME IS "N$(I):X$=LEFT$(N$(I),1):PRINT"THE NAME MUST START WITH THE    LETTER "X$"."390 INPUT"ENTER NEW NAME";Y$:IFX$<>LEFT$(Y$,1)THENPRINT:GOTO380ELSEN$(I)=Y$:CLS:NEXT400 FORI=0TONS:IFS(I,0)=4THEN480ELSEC=C+1:IFC=4THENC=1410 D=D+1:IFD=5THEND=1420 RA=RND(-TIMER):X=RND(5):Y=RND(5):OND-1GOSUB430,440,450:GOTO460430 X=X+5:RETURN440 Y=Y+5:RETURN450 X=X+5:Y=Y+5:RETURN460 FORJ=0TONS:IFX=S(J,1) ANDY=S(J,2) THEN420ELSENEXT470 S(I,0)=C:S(I,1)=X:S(I,2)=Y:S(I,3)=-1:IFC=3THENS(I,4)=RND(3)480 NEXT490 PRINT"WORKING...":T=T+1:FORI=0TONS:FORJ=0TO4+NP:B(I,J)=0:NEXT:C=S(I,3):IFC=-2THENC=-1500 B(I,4+C)=S(I,4):NEXT510 FORP=0TONP:FORI=0TO9:IFW(P,I,2)<>T THEN540ELSEC=W(P,I,0)520 S(C,5+P)=1:IFB(C,4+P)=0THENB(C,0)=1530 B(C,4+P)=B(C,4+P)+W(P,I,1):FOR J=0 TO 2:W(P,I,J)=0:NEXT540 NEXT:NEXT550 FORI=0TONS:C=0:FORJ=3TO4+NP:IFB(I,J)>0THENC=C+1:K=J560 NEXT:IFC=0THEN630ELSEIFC=1THENB(I,1)=K-4:S(I,3)=K-4:S(I,4)=B(I,K):GOTO630570 B(I,0)=2:X=0:Y=0:X1=0:FORJ=3TO4+NP:IFB(I,J)=X THENY=Y+1ELSEIFB(I,J)>X THENX=B(I,J):X1=J:Y=1580 NEXT:IFY>1THEN620590 B(I,1)=X1-4:Y=0:FORJ=3TO4+NP:IFJ=X1 THEN600ELSEIFB(I,J)>Y THENY=B(I,J)600 NEXT:B(I,2)=INT(Y/2+0.5):S(I,3)=B(I,1)::S(I,4)=B(I,X1)-B(I,2):IFS(I,0)=3ANDS(I,3)<0THENS(I,3)=-2610 GOTO630620 B(I,1)=-2:S(I,3)=-1:S(I,4)=0:IFS(I,0)=3THENS(I,3)=-2:S(I,4)=RND(2)630 NEXTI640 FORP=0TONP:FORI=0TO9:IFW(P,I,2)=0THENW(P,I,2)=9999650 NEXT660 C=0:FORI=0TO8:IFW(P,I,2)<=W(P,I+1,2)THEN680670 FORJ=0TO2:K=W(P,I,J):W(P,I,J)=W(P,I+1,J):W(P,I+1,J)=K:NEXT:C=C+1680 NEXT:IFC>0THEN660690 FORI=0TO9:IFW(P,I,2)=9999THENW(P,I,2)=0700 NEXT:NEXT710 FORP=0TONP:IF F$(P)="C"THENGOSUB1920:GOTO1590720 IFE(P,1)=-1THEN1590ELSEGOSUB140:CLS:PRINTTAB(11)"STARDATE"T:PRINT@64,STRING$(32,61);:PRINT@140,"PLAYER"P+1:PRINT@386,"  PRESS ANY KEY WHEN READY":X$=INKEY$730 SOUND200,1:SOUND10,3:PRINT@320,STRING$(32,61);:PRINT@234,"ADMIRAL "F$(P);740 X$=INKEY$:IFX$=""THEN740ELSECLS:PRINT"PLAYER"P+1:GOSUB750:GOTO920750 C=0:PRINT"BATTLE RESULTS FOR STARDATE"T:PRINT760 FORI=0TONS:IFB(I,0)=0ORB(I,4+P)=0THEN900ELSEC=C+1770 PRINT"STAR SYSTEM:"N$(I)" ("S(I,1)","S(I,2)")":PRINT"CLASS:"S(I,0):GOTO790780 IF C>1 THENX$="S":RETURN:ELSEX$="":RETURN790 C=B(I,4+P):GOSUB780:IF B(I,0)=1 THENPRINT"YOUR"C"STARSHIP"X$" ARRIVED AT THE":PRINT"STAR SYSTEM.":PRINT"THE STAR SYSTEM OF "N$(I)" IS":PRINT"NOW PART OF YOUR EMPIRE.":GOTO 890800 PRINT"YOUR"C"STARSHIP"X$" WENT INTO":PRINT"BATTLE AGAINST";810 IF B(I,3)>0THENC=B(I,3):GOSUB780:PRINTC"NATIVE WARSHIP"X$820 FOR J=0 TO NP:IF J=P OR B(I,4+J)=0 THEN 840830 C=B(I,4+J):GOSUB780:PRINTC"STARSHIP"X$:PRINT"FROM YOUR ENEMY PLAYER"J+1840 NEXT850 IF B(I,1)=-2 THEN PRINT"ALL STARSHIPS CONCERNED WERE    DESTROYED":GOTO890860 C=B(I,2):GOSUB780:IF B(I,1)=-1 THEN PRINT"THE NATIVE FORCE WAS VICTORIOUS, BUT THEY LOST"C"WARSHIP"X$:GOTO 890870 IF B(I,1)<>P THENPRINT"PLAYER"B(I,1)+1"WAS THE VICTOR, BUT HE LOST"C"STARSHIP"X$:GOTO 890880 PRINT"YOUR FORCE WAS VICTORIOUS":PRINT"THE STAR SYSTEM "N$(I)" IS NOW":PRINT"PART OF YOUR EMPIRE":PRINT"YOU DID LOSE"C"STARSHIP"X$"."890 INPUT"PRESS <ENTER> TO CONTINUE";X$:PRINT900 NEXT:IF C=0THENPRINT"THERE HAVE BEEN NO BATTLES OR   NEW ARRIVALS ON STARDATE"T:PRINT910 RETURN920 FOR I=0TONS:IFS(I,0)=4 THEN 1760 ELSE IF S(I,0)<>3 OR S(I,3)<>P THEN 1040930 C=25-5*S(I,4):IF C<5THEN C=5940 X=RND(100):IFX>C THEN1040950 PRINT"THERE HAS BEEN A REBELLION ON":PRINTN$(I)"!!!"960 C=20*S(I,4):X=RND(100):IF X>C THEN 1000970 PRINT"WHICH WAS QUICKLY PUT DOWN BY   YOUR LOYAL TROOPS."980 C=RND(3):IF C>S(I,4)THEN C=S(I,4)-1:IF C=0 THEN 1030990 GOSUB780:PRINT"BUT THE REBELS DID DESTROY":PRINTC"STARSHIP"X$:S(I,4)=S(I,4)-C:GOTO 10301000 PRINT"WHICH COULD NOT BE CONTAINED BY YOUR FORCES!!!"1010 C=S(I,4):GOSUB 780:PRINT"YOU HAD"C"STARSHIP"X$:PRINT"STATIONED AT "N$(I)",":PRINT"ALL OF WHICH WERE DESTROYED."1020 PRINT"LONG LIVE THE REVOLUTION!!":S(I,3)=-2:S(I,4)=RND(2)1030 INPUT"PRESS ENTER TO CONTINUE";X$:PRINT1040 NEXTI1050 IF S(E(P,0),3)<>P THENPRINT"NO HOME STAR - NO INCOME!!":GOTO 11801060 PRINT"INCOME CALCULATION":C=01070 PRINT"SYSTEM      CLASS      OUTPUT"1080 FORI=0 TO NS:IF S(I,3)<>P THEN 11501090 ONS(I,0)GOSUB1100,1110,1120,1130:C=C+X:GOTO11401100 X=1:RETURN1110 X=RND(3):RETURN1120 X=2+RND(3):RETURN1130 X=5+RND(5):RETURN1140 PRINTN$(I)TAB(13)S(I,0)TAB(24)X"RU"1150 NEXT:PRINT"TOTAL OUTPUT:"C"RU ":E(P,1)=E(P,1)+C1160 PRINT"TOTAL RESOURCE UNITS:"E(P,1):C=INT(E(P,1)/5):GOSUB7801170 E(P,1)=INT(E(P,1)-5*C):PRINT"THIS ALLOWS PRODUCTION OF"C:PRINT"STARSHIP"X$:S(E(P,0),4)=S(E(P,0),4)+C:INPUT"PRESS ENTER TO CONTINUE";X$:PRINT1180 X$="":PRINT"STARDATE"T"  WHAT IS YOUR":PRINT"COMMAND (0 FOR LIST)";:INPUTX$1190 IFX$=""THENX$="8"1200 Z=VAL(X$)1210 ON Z+1 GOSUB 1220,1250,1310,1350,750,1440,1490,1890:IFZ=8THEN1590ELSEIFZ=9THEN1580ELSE11801220 PRINT"1 DISPLAY YOUR STAR MAP":PRINT"2 GIVE DISTANCE BETWEEN 2 STARS":PRINT"3 LIST STARSHIPS IN HYPERSPACE"1230 PRINT"4 REVIEW BATTLE DATA":PRINT"5 LIST DATA ON STAR SYSTEMS":PRINT"6 SEND STARSHIPS TO HYPERSPACE"1240 PRINT"7 LEAVE/READ MESSAGE":PRINT"8 END TURN":PRINT"9 RESIGN FROM GAME":RETURN1250 CLS:PRINT1260 FORI=1TO10:PRINT"  -  -  -  -  -  -  -  -  -  -":NEXT1270 FORI=0TONS:IFS(I,5+P)=1THENX$=RIGHT$(STR$(S(I,0)),1)ELSEX$="?"1280 X$=X$+CHR$(I+65):IFS(I,3)=P THENC=159ELSEC=2551290 X$=X$+CHR$(C):PRINT@(S(I,1)*32+S(I,2)*3-2),X$;:NEXT1300 PRINT@384,"";:RETURN1310 PRINT:INPUT"ENTER THE 1ST LETTER OF THE TWO STARS NAMES";X$,Y$:IFX$=""ORY$=""THENX$="Z":Y$="Z":ELSEX=ASC(X$)-65:Y=ASC(Y$)-651320 IFX<0ORX>NS ORY<0ORY>NS THENPRINT"YOU DON'T MAKE ANY SENSE!":RETURN1330 GOSUB1340:GOSUB780:PRINT"THE DISTANCE IS"C"PARSEC"X$".":PRINT:RETURN1340 C=INT(SQR((S(X,1)-S(Y,1))^2+(S(X,2)-S(Y,2))^2)+0.5):RETURN1350 PRINT:PRINT"STARSHIPS IN HYPERSPACE:":PRINT" NUMBER/DESTINATION/DUE STARDATE"1360 IFW(P,0,2)=0THENPRINT"THERE ARE NONE":PRINT:RETURN1370 FORI=0TO9:IFW(P,I,2)=0THEN14301380 C=W(P,I,1):GOSUB7801390 IF C<10THENPRINT"   ";:ELSEPRINT"    ";1400 PRINTC;1410 PRINT"  "N$(W(P,I,0));1420 PRINTTAB(22)W(P,I,2)1430 NEXT:PRINT:RETURN1440 PRINT:PRINT"DATA ON STAR SYSTEMS":PRINT"SYSTEM  LOCATION  CLASS  SHIPS"1450 FORI=0 TO NS:IFS(I,3)<>P THEN 14801460 PRINTN$(I)TAB(10)S(I,1)","S(I,2)"   "S(I,0)"   ";1470 IF S(I,3)=P THENPRINTS(I,4)ELSEPRINT"0"1480 NEXT:PRINT:RETURN1490 FORI=0 TO 9:IFW(P,I,2)=0THEN1500 ELSE NEXT:PRINT"YOU ALREADY HAVE 10 FLEETS IN HYPERSPACE.":RETURN1500 PRINT:INPUT"ENTER THE LETTER OF THE START   AND END STAR SYSTEMS";X$,Y$:IF X$="" OR Y$="" THEN X$="Z":Y$="Z":ELSEX=ASC(X$)-65:Y=ASC(Y$)-651510 IF X<0 OR X>NS OR Y<0 OR Y>NS THEN 13201520 IF X=Y THEN PRINT"YOU DON'T MAKE ANY SENSE!":RETURN1530 IF S(X,3)<>P THENPRINT"YOU HAVE NO STARSHIPS AT "N$(X)".":RETURN1540 C=S(X,4):GOSUB780:PRINT"THERE ARE"C"SHIP"X$" AT "N$(X)".":X$="":INPUT"HOW MANY ARE LEAVING";X$:K=VAL(X$):IF K<1 THEN PRINT"A GHOST FLEET, EH?":RETURN1550 IF K>S(X,4)THENPRINT"TOO MANY!":RETURN1560 S(X,4)=C-K:IF S(X,4)=0 THEN S(X,3)=-1:IF S(X,0)=3 THEN S(X,3)=-21570 W(P,I,0)=Y:W(P,I,1)=K:GOSUB1340:W(P,I,2)=T+C:PRINT"THE FLEET WILL ARRIVE AT STAR-  DATE"T+C".":PRINT:RETURN1580 E(P,1)=-11590 CLS:NEXTP1600 FOR I=0 TO NS:IF S(I,3)<>-2 THEN 16201610 IF S(I,0)=4 THEN S(I,4)=S(I,4)+1 ELSE IF RND(10)<7 THENS(I,4)=S(I,4)+11620 NEXT:IF T=MT THEN1680 ELSE K=01630 FOR P=0 TO NP:IF E(P,1)=-1 THEN K=K+1ELSE C=P1640 NEXT:IF K<>NP THEN 490 ELSE GOSUB1401650 PRINT"PLAYER"C+1"HAS WON!!  CONGRATS!"1660 INPUT"WOULD YOU LIKE TO PLAY AGAIN    (Y/N)";X$1670 IF LEFT$(X$,1)="Y" THEN RUN ELSE CLS:END1680 FORP=0TONP:W(P,0,0)=0:NEXT1690 FOR I=0TONS:IF S(I,3)>-1 THEN W(S(I,3),0,0)=W(S(I,3),0,0)+S(I,0)1700 NEXT:FORP=0 TO NP:IFE(P,1)=-1 OR S(E(P,0),3)<>P THEN W(P,0,0)=01710 PRINT"PLAYER"P+1"HAS A SCORE OF"W(P,0,0)".":NEXT1720 X=0:Y=0:C=0:FORP=0TONP:IFW(P,0,0)=X THENY=Y+1ELSEIFW(P,0,0)>X THENX=W(P,0,0):Y=1:C=P1730 NEXT:IFY>1THENPRINT"THERE IS NO DEFINITE WINNER.":GOTO16601740 PRINT:PRINT"PLAYER"C+1"HAS WON!":GOTO16601750 DATAALTAIR,BETELGEUSE,CAPELLA,DENEB,ERIDANI,FORNAX,GEMINI,HADAR,INDI,JACARA,KATENCOR,LAPERTAE,MIZAR,NORYON,OPIUM,PROCYON,QUEATUS,RIGEL,SIRIUS,THORUS,UTOPIA,VENORA,WEREWORLD,XARNIA1760 IFS(I,3)=P AND E(P,0)THEN1770ELSE10401770 C=50-S(I,4)*5:IFC>10THENC=101780 X=RND(100):IFX>C THEN10401790 PRINT"THERE HAS BEEN A REVOLT ON THE  CLASS 4 SYSTEM OF "N$(I)1800 C=S(I,4)*10:X=RND(100):IFX>C THEN 18401810 PRINT"WHICH WAS PUT DOWN WITH SOME    DIFFICULTY BY YOUR TROOPS"1820 C=RND(5):IFC>=S(I,4)THENC=S(I,4)-1:IFC=0THEN10301830 GOSUB780:PRINT"THE WELL-EQUIPPED REBELS        DESTROYED"C"STARSHIP"X$:S(I,4)=S(I,4)-C:GOTO10301840 C=S(I,4):GOSUB780:PRINT"YOUR FORCE OF"C"STARSHIP"X$" WAS":PRINT"VASTLY OVERWHELMED BY THE REBEL ARMY ... LONG LIVE THE          REVOLUTION!"1850 S(I,3)=-2:S(I,4)=RND(3)1860 FORC=0TONP:IFE(C,0)=I THEN1870ELSENEXTC1870 IFE(C,1)<>-1THENS(I,3)=C1880 GOTO10301890 CLS:PRINT"  INTERSTELLAR COMMUNICATIONS":FORM=0TONP:PRINTF$(M)" (PLAYER #"M+1")":PRINT"MESSAGE: "M$(M):PRINT:NEXTM1900 INPUT"CHANGE YOUR MESSAGE (Y/N)";X$:IFLEFT$(X$,1)="Y"THENPRINT:INPUT"NEW MESSAGE: ";M$(P)1910 RETURN1920 CLS:PRINT"COMPUTER DECIDING MOVE":IFT=1THENGOSUB20601930 IFS(E(P,0),3)<>P THEN19801940 C=0:FORI=0TONS:IFS(I,3)<>P THEN19601950 ONS(I,0)GOSUB1100,1110,1120,1130:C=C+X1960 NEXTI:E(P,1)=E(P,1)+C:C=INT(E(P,1)/5)1970 E(P,1)=INT(E(P,1)-5*C):S(E(P,0),4)=S(E(P,0),4)+C1980 IFS(E(P,0),4)<=T THENRETURN1990 FORK=0TO9:IFW(P,K,2)=0THEN2000ELSENEXTK:RETURN2000 FORI=1TONS:IFS(X(P,I),3)=P THENNEXTI:RETURN2010 Y=X(P,I):X=E(P,0):RA=INT(RND(T/2)):S(X,4)=S(X,4)-RA:IFS(X,4)=0THENS(X,3)=-1:IFS(X,0)=3THENS(X,3)=-22020 IFRA=0THENRETURN2030 W(P,K,0)=Y:W(P,K,1)=RA:GOSUB1340:W(P,K,2)=T+C:GOSUB21202040 IFS(E(P,0),4)<=T THENRETURN2050 NEXTI:NEXTK:RETURN2060 X=E(P,0):FORY=0TONS:GOSUB1340:D(Y)=C:NEXTY2070 Z=02080 DM=99:FORY=0TONS2090 IFD(Y)<=DM THENDM=D(Y):C=Y2100 NEXTY:X(P,Z)=C:Z=Z+1:D(C)=992110 IFZ>NS THENRETURNELSE20802120 RA=RND(4):ONRA GOTO2130,2140,2150,21602130 M$(P)="I'LL GET YOU YET!":RETURN2140 M$(P)="JUST WAIT SIX TURNS!":RETURN2150 M$(P)="I WILL RULE THE GALAXY!":RETURN2160 M$(P)="I'M WAITING FOR YOU!":RETURN