1005 A=USR4(0):U1$=" HIT POINTS":U2$=" EXPERIENCE POINTS":U3$="YOU GAIN":U4$="YOU LOSE":U5$=" POINTS DAMAGE":U6$="YOU FEEL BETTER":U9$="<ENTER> TO ":U7$="NOTHING HAPPENS...":U8$="YOU SUFFER1015 S$="STRINTWISCONDEXCHR1035 T$="REFUSESILVERGOLD  GEMS  JEWELS1100 DIMP(3,3),ST(5),SF(11),MI$(10),MA$(10),I(10),SP$(36),B(4),FM(20),FL(20),FH(20)1103 XO=1.6915:YO=1.4278:ZO=1.2462:WO=46941105 MI$(1)="SWORD":MI$(2)="ARMOR":MI$(3)="SHIELD":FORX=1TO3:MA$(X)=MI$(X):NEXT1120 MI$(4)="ELVIN CLOAK":MA$(4)="ELVN CLK":MI$(5)="ELVIN BOOTS":MA$(5)="ELVN BTS":MI$(6)="RING OF REGENERATION":MA$(6)="RING REG1135 MI$(7)="RING OF PROTECTION":MA$(7)="RING PROT":MI$(8)="SCROLL OF RESCUE":MA$(8)="SCRL RESC":MI$(9)="POTION OF HEALING":MA$(9)="POT HEAL":MI$(10)="POTION OF STRENGTH":MA$(10)="POT STRG1155 CM$="NSWED^"+CHR$(10)+CHR$(8)+CHR$(9)+"@HQFCA"+CHR$(12)+"RUG1160 FORI=1TO36:READSP$(I):NEXT:FORI=1TO20:FM(I)=0:NEXT1162 DATAMAGIC MISSLE,SLEEP,CURE LIGHT WOUNDS,LIGHT,TURN UNDEAD,PROT/EVIL,WEB,LEVITATE,CAUSE LIGHT WNDS,DETECT TRAPS,CHARM,STRENGTH,LIGHTNING BOLT,CURE SERIOUS WNDS,CONTINUAL LIGHT,INVISIBILITY1167 DATAHOLD MONSTER,PHANTSML FORCES,PASS WALL,FIREBALL,CAUSE SERIOUS WNDS,FLESH TO STONE,FEAR,FINGER OF DEATH,TELEPORT,ASTRAL WALK,POWER WORD KILL,ICE STORM,WALL OF FIRE,PLAGUE1171 DATATIME STOP,RAISE DEAD,HOLY SYMBOL,WORD OF RECALL,RESTORATION,PRISMATIC WALL1215 E=672:GOSUB16000:IFC$="@"THEN12151216 IFC$<>"R"THENQ$="START":GOSUB35000:GOSUB19000:GOTO14001220 Q$="READ":GOSUB35000:E=704:Q$="YOUR NAME":GOSUB35000:A=USR6(0):E=736:GOSUB36000:NM$=N$1225 OPEN"I",1,NM$+"/PLR":GOTO12451245 INPUT#1,NM$:LN=8:Q$=NM$+" FOUND":GOSUB370001250 INPUT#1,VS:FORI=0TO5:INPUT#1,ST(I):NEXT1260 INPUT#1,LV,GD,TG,EX,CH,HP,CX,CY,CZ,SU,CS1270 FORI=1TO10:INPUT#1,I(I),SF(I):NEXT:INPUT#1,SF(11)1275 FORI=1TO20:INPUT#1,FM(I),FL(I),FH(I):NEXT1280 FORI=1TO4:INPUT#1,B(I):NEXT:IFCZ=0THENCZ=11295 CLOSE1300 PCLS1:GOSUB20300:GOSUB30025:SY=1:GOTO20001400 PCLS1:E=6:Q$=U9$+"USE STATS":GOSUB350001500 E=77:FORI=0TO5:Q=0:FORQ1=1TO3:Q=Q+RND(6):NEXT:ST(I)=Q1510 E=E+64:Q$=MID$(S$,I*3+1,3)+STR$(ST(I)):GOSUB35000:NEXT:GOSUB16000:IFC$<>CHR$(13)THEN14001520 HP=ST(3):CH=HP:GD=0:TG=0:CZ=1:LV=1:FORI=1TO10:I(I)=0:SF(I)=0:NEXT:SF(11)=0:GOSUB198001600 CX=25:CY=13:EX=0:SU=1:CS=1:E=582:Q$="YOUR NAME, NOBLE SIR":GOSUB35000:E=684:GOSUB36000:NM$=N$1610 FORX=1TO8:A=USR6(0):NEXT:Q$="YOU ARE DECENDING INTO THE":GOSUB37005:Q$="DEPTHS OF THE TELENGARD DUNGEON":GOSUB37005:FORX=1TO3:A=USR6(0):NEXT:Q$="BEWARE...":GOSUB370051630 GOSUB19000:GOSUB19000:PCLS1:L=1:GOSUB20300:GOSUB15000:SY=1:GOTO30002000 FORI=1TO11:SF(I)=SF(I)-1:NEXT2005 L=CZ:GOSUB17000:IFSY=1THENGOSUB150002010 SY=1:IFI(6)=0ORCH=HP THEN30002015 CH=CH+I(6):IFCH>HP THENCH=HP2020 GOSUB203003000 IFRND(0)>.3THEN40003001 IFSF(6)>0ANDRND(0)>.2THEN40003005 Q$="m":GOSUB40010:M=RND(20)3006 IFRND(20)<=I(4)THEN209003007 ML=INT((RND(0)^1.5)*(CZ*2+1)+1):GOSUB207003008 IFSF(3)>0ANDUN=1ANDRND(0)>.8THEN30053010 GOSUB16500:GOSUB19700:Q$="YOU MEET A LEVEL"+STR$(ML)+" "+M$:GOSUB370003011 IFSF(9)>0ANDM<16ANDM<>11THENGOSUB17500:GOTO40003012 LINE(0,119)-(128,119),PSET:E=480:Q$="LVL"+STR$(ML)+" "+M$:GOSUB350103013 IFSF(7)>0ANDM<9THENQ$="IT RUNS AWAY IN FEAR":GOSUB37000:ML=ML/2:GOTO32233015 MH=INT((RND(0)^.5)*ML*M+1):L=ML3017 IFRND(0)>.95THENONRND(3)GOTO3030,3045,30723020 IFM<>9THEN30403025 IFRND(0)>.04*ST(5)THEN30403030 Q$="THE "+M$+" LIKES YOUR BODY":GOSUB37000:Q$="HE HEALS YOU TO FULL STRENGTH":CH=HP3037 GOSUB37300:GOSUB19000:GOSUB20600:Q$=" ":GOSUB40010:GOTO40003040 IFM<>4ORRND(0)<.04*ST(5)THEN30703045 Q$="THE "+M$+" MAKES A QUICK MOVE":GOSUB379003050 FORI=1TO10:IFI(I)>0THEN30563052 NEXT:Q$="YOU'VE NOTHING HE WANTS TO TAKE":GOTO30373056 IFI<8THENQ$="HE STEALS YOUR "+MI$(I):I(I)=0:GOTO30373060 Q$="HE STEALS A "+MI$(I):I(I)=I(I)-1:GOTO30373070 IFM<>20ORRND(0)*30>ST(3)THEN30903072 I=RND(7):IFI(I)>=ML THEN30903074 C=ML-I(I):C=RND(C):I(I)=I(I)+C3076 Q$="THE "+M$+" LIKES YOU!":GOSUB375003078 Q$="HE GIVES YOU A ":GOSUB37000:Q$=MI$(I)+" +"+STR$(I(I)):GOSUB37300:GOSUB175003080 Q$=" ":GOSUB40010:GOSUB20600:GOTO40003090 IFRND(0)>.5+ST(4)*.02THEN33003100 Q$="<F>IGHT, <C>AST, OR <A>VOID":GOSUB376003102 IFC$="@"THENQ$="WAIT":GOSUB370003105 FORI=1TO4:IFMID$("FCA@",I,1)=C$THEN31153110 NEXT:Q$="THE "+M$+" IS NOT AMUSED":GOSUB37500:GOTO31003115 ONI GOTO3200,3400,3700,33003200 I=INT(RND(0)*20)+LV+I(1)+ST(0)/2:Q$="FIGHT":GOSUB370003202 IFSF(1)>0THENNI=I+43204 IFI<10THENQ$="YOU MISSED...":GOTO333003205 I=INT(RND(0)*8+RND(0)*LV+2+I(1)+1):IFSF(1)>0THENNI=I+53207 Q$="YOU DO"+STR$(I)+U5$3210 GOSUB37000:MH=MH-I:IFMH>0THEN33003220 Q$="IT DIED...":GOSUB370003223 Q$=" ":GOSUB40010:GOSUB40000:X=ML*M*10:EX=EX+X:GOSUB190003225 GOSUB20600:GOSUB17000:Q$=U3$+STR$(X)+U2$:GOSUB37300:GOSUB180003230 GOSUB17500:GOTO39003300 DB=1:PA=0:DR=0:MB=0:GOTO33303305 I=INT(RND(0)*20)+ML-I(2)-I(3)+MB3306 IFM>16ANDM<20ANDSF(4)>0THENNI=I-63310 IFI<10THENQ$="IT MISSED...":GOSUB37500:GOTO31003315 I=INT((RND(0)*8+RND(0)*ML*2+1)*DB):GOSUB34000:IFCH<1THEN90003321 GOSUB19000:IFRND(0)*1.5>DR ORSF(4)>0THEN33263322 GOSUB17000:Q$="IT DRAINS A LEVEL!!!":EX=INT(EX/2)3324 GOSUB37000:GOSUB18000:GOSUB17500:GOTO33103326 IFRND(0)>PA THENGOSUB17500:GOTO31003327 GOSUB17000:Q$="YOU'RE PARALYZED!!":GOSUB37500:GOTO33003330 IFM=13THENDR=.1:GOTO33053335 IFM=17THENDR=.2:GOTO33053340 IFM=18THENDR=.3:PA=.3:GOTO33053345 IFM=10THENPA=.5:GOTO33053350 IFM<>19THEN33653352 GOSUB175003355 IFRND(0)>.6THENQ$="IT USES ITS SWORD!!":GOSUB37000:MB=4:DB=3:GOTO33053360 Q$="IT USES ITS WHIP!!":GOSUB37000:MB=2:DB=2:GOTO33053365 IFM<>20THEN33053370 IFRND(0)>.3THENMB=5:DB=2:GOTO33053375 Q$="THE DRAGON BREATHES FIRE!!!":GOSUB375003378 I=RND(ML*20):IFRND(0)<.05*ST(3)THEN33823380 Q$="YOU PARTIALLY DODGE IT":GOSUB37000:I=INT(I/2+.5)3382 Q$="YOU BURN FOR"+STR$(I)+U5$:GOSUB37000:CH=CH-I:GOSUB20260:IFCH<1THEN90003400 D=1:GOTO210003700 Q=RND(18):Q$="AVOID3705 GOSUB37000:IFQ<ST(4)+I(5)THEN37103707 Q$="YOU'RE ROOTED TO THE SPOT":GOSUB37500:GOSUB16500:GOTO33003710 IFSF(8)>0THENC=RND(4):GOTO37953715 ONRND(4)GOTO3720,3730,3740,37503720 C=1:IF(LL AND3)<3THEN37953730 C=2:IF(P(2,1)AND3)<3THEN37953740 C=3:IF(INT(LL/4)AND3)<3THEN37953750 C=4:IF(INT(P(1,2)/4)AND3)<3THEN37953760 C=1:IF(LL AND3)<3THEN37953770 C=2:IF(P(2,1)AND3)<3THEN37953780 C=3:IF(INT(LL/4)AND3)<3THEN37953790 GOTO37073795 GOSUB20600:GOSUB17000:GOTO81203900 IFRND(0)>.5THEN40024000 IFRND(0)>.2THEN60004002 T=0:IFRND(0)>.85THENT=14005 Q$="]":GOSUB40000:GOSUB16500:C=0:IFRND(0)>.7THEN41004007 I=RND(5)-14010 Q$="YOU SEE SOME "+MID$(T$,I*6+1,6):GOSUB37000:Q$=U9$+"PICK UP4011 IFT=1THENIFSF(2)>0ANDRND(0)>.1THENGOSUB37000:Q$="YOU DETECT TRAPS!4012 GOSUB37600:IFC$=CHR$(13)THEN40204015 Q$="LEAVE IT":GOSUB37500:GOTO60004020 Q$="SNARF IT":GOSUB37000:IFT=0THEN40404025 Q=RND(L*3):GOSUB170004030 Q$="IT'S TRAPPED!":GOSUB37000:Q$=U8$+STR$(Q)+U5$4035 GOSUB37000:CH=CH-Q:GOSUB20260:IFCH<1THENGOSUB19000:GOTO90004040 J=INT(RND(0)*I*L*200+1):Q$="IT'S WORTH"+STR$(J)+" GOLD4045 GOSUB37000:GD=GD+J:IFI=0ANDRND(0)>.8THENGOSUB20300:GOSUB17000:GOTO42004050 GOSUB20300:GOTO49004100 IFRND(0)>.5THEN42004105 Q$="YOU FOUND A TREASURE CHEST!!4110 GOSUB37000:Q$=U9$+"OPEN IT4115 IFT=1THENIFSF(2)>0ANDRND(0)>.1THENGOSUB37000:Q$="YOU DETECT TRAPS!4120 GOSUB37600:IFC$<>CHR$(13)THENQ$="IGNORE IT":GOSUB37000:GOTO60004125 Q$="OPEN IT":GOSUB37000:IFT=0THEN41404130 GOSUB17500:Q$="CHEST EXPLODES!!":GOSUB37000:I=RND(10*CZ):CH=CH-I4135 Q$=U8$+STR$(I)+U5$:GOSUB37000:GOSUB20260:IFCH<1THEN90004140 GOSUB17500:I=INT(RND(0)*(1000*LV^2)+1)4145 IFRND(0)>.9THENQ$="INSIDE, THERE ARE ONLY COBWEBS..":GOSUB37000:GOTO49004150 Q$="INSIDE IS"+STR$(I)+" GOLD PIECES!":GD=GD+I:GOSUB37300:IFRND(0)>.5THEN49004155 C=1:GOSUB175004200 I=RND(10)4205 C$="YOU SEE ":J=INT(RND(0)^.5*(L+1)+1):IFI>7THENQ$=C$+MI$(I):GOTO42154210 Q$=C$+MI$(I)+" +"+MID$(STR$(J),2)4215 GOSUB37000:Q$=U9$+"PICK IT UP":GOSUB37600:IFC$=CHR$(13)THEN42254220 Q$="LEAVE IT":GOSUB37000:GOTO42404225 IFI<>1ORT<>1THEN42354230 Q$="IT'S A HOSTILE SWORD!!":GOSUB37000:I=RND(I*5)4232 Q$=U8$+STR$(I)+U5$:CH=CH-I:GOSUB37300:IFCH<1THEN90004234 GOTO49004235 Q$="IT'S YOURS!":I(I)=I(I)+1:IFI<8THENI(I)=J4237 GOSUB373004240 IFC=1ANDRND(0)>.5THENGOSUB17500:GOTO42004900 Q$=" ":GOSUB40000:GOSUB175004910 IFRND(0)>.5THENGOSUB30000:IFM<>0THEN30106000 X=CX:Y=CY:Z=CZ-1:GOSUB100106002 J=INT(HH/256):I=INT(LL/256)6005 IFCZ=1THENJ=06010 IFI>9THENI=I-9:GOTO60106012 IFJ>9THENJ=J-9:GOTO60126013 IFCZ=50ANDI=4THENI=06014 IFI=0ANDJ<>4THEN80106015 IFJ=4THEN65006020 ONI GOTO6100,6300,6400,6500,6600,6700,6800,6900,71006100 IFCZ<>1THEN62006102 J=4:GOTO65006103 Q(1)=CX*CY:Q(2)=CX+CY:Q(3)=CX*3+CY*7:Q(1)=Q(1)-INT(Q(1)/10)*10+1:Q(2)=Q(2)-INT(Q(2)/10)*10+1:Q(3)=Q(3)-INT(Q(3)/10)*10+16105 GOSUB17000:A=USR5(0):GOSUB390006106 W=3:LL=197:GOSUB10050:LL=325:GOSUB10050:LL=197:GOSUB10075:LL=202:GOSUB10075:E=263:Q$="[":GOSUB350106108 Q$="INN":GOSUB40000:E=355:FORX=1TO3:E=E+33:Q$=N$(X):GOSUB35010:NEXT6110 GOSUB16500:Q$="YOU HAVE FOUND THE":GOSUB37000:Q$=N$(1)+N$(2)+N$(3):GOSUB370006111 Q$="THEY CASH IN YOUR GOLD":EX=EX+GD:TG=TG+GD:GD=0:GOSUB373006115 GOSUB18000:GOSUB30200:GOSUB17000:CH=HP:Q$="YOU HAVE"+STR$(TG)+" IN THE SAFE6116 GOSUB37000:FORI=0TO11:SF(I)=0:NEXT6119 CS=SU:Q$="YOU SPEND THE NIGHT":GOSUB379006120 Q$=U6$:GOSUB37300:GOSUB170006125 Q$=U9$+"RETURN TO DUNGEON,":GOSUB370006130 Q$="<CLEAR> TO SAVE CHARACTER:":GOSUB370006135 GOSUB16000:IFC$="@"THEN61356140 IFC$=CHR$(12)THEN86006142 IFC$<>CHR$(13)THENGOSUB17500:GOTO61256145 Q$="REENTER":GOSUB37500:CZ=1:GOTO20006200 Q$="ELV":GOSUB40000:GOSUB16500:Q$="YOU FEEL HEAVY FOR A MOMENT6210 GOSUB37900:CZ=CZ-1:GOTO20006300 IFCZ=50THEN62006302 Q$="PIT":GOSUB40000:GOSUB16500:Q$="YOU SEE A PIT6303 GOSUB37000:IFSF(5)>0THENQ$="YOU ARE HOVERING ABOVE A PIT":GOSUB37000:GOTO63106305 IFRND(20)-1>ST(4)+I(5)THEN63306310 Q$="DO YOU WANT TO DESCEND?":GOSUB37600:IFC$="Y"THEN63206315 Q$="NO":GOSUB37500:GOTO80106320 Q$="YES":GOSUB37000:GOTO63356330 Q$="YOU FALL IN!":L=3:GOSUB20000:GOSUB379006335 CZ=CZ+1:GOTO20006400 Q$="TPT":GOSUB40000:GOSUB165006403 Q$="ZZAP! YOU'VE BEEN TELEPORTED..":GOSUB373006405 IF((CX+CY)AND1)=0THENCZ=CZ-1:IF((CX+CY)AND2)=2THENCZ=CZ+26410 CX=CZ*8+CY*13:CY=CY+CZ*6+CX*176415 IFCX>200THENCX=CX-200:GOTO64156420 IFCY>200THENCY=CY-200:GOTO64206425 IFCZ=0THENCZ=16430 IFCZ>50THENCZ=506435 IFRND(0)>.8THEN64056440 GOTO20006500 IFJ=4THENQ$=" ^":GOSUB400006505 IFI=4THENQ$=" "+CHR$(92):GOSUB400006510 GOSUB17000:Q$="YOU FOUND A CIRCULAR STAIRWAY":GOSUB370006512 IFJ=4ANDCZ=1THENQ$="YOU SEE LIGHT ABOVE":GOSUB370006515 Q$="DO YOU WANT TO":GOSUB370006520 Q$="":IFJ=4THENQ$="GO <U>P, "6525 IFI=4THENQ$=Q$+"GO <D>OWN,6530 GOSUB37000:Q$="OR <S>TAY ON THE SAME LEVEL?":GOSUB376006532 IFC$="@"THENC$="S"6535 IF(I<>4ANDC$="D")OR(J<>4ANDC$="U")THEN65106540 IFC$="U"THENQ$="UP":GOSUB37000:CZ=CZ-1:IFCZ>0THEN20006542 IFCZ<=0THEN61036545 IFC$="D"THENQ$="DOWN":GOSUB37000:CZ=CZ+1:GOTO20006547 IFC$="S"THENQ$="STAY":GOSUB37700:GOTO80106550 GOTO65106600 Q$="ALT":GOSUB40000:GOSUB17000:Q$="YOU HAVE FOUND A HOLY ALTAR6605 GOSUB37000:Q$=U9$+"WORSHIP":GOSUB37600:IFC$=CHR$(13)THEN66306610 IFRND(0)>.7THEN80106615 Q$="DIRTY PAGAN TRASH!":GOSUB37000:Q$="   ":GOSUB40000:Q$="m":GOSUB400106620 M=INT(RND(0)*20+1):GOSUB20700:IFUN=0THEN66206625 GOSUB17500:GOTO30076630 Q$=U9$+"DONATE":GOSUB376006632 IFC$<>CHR$(13)THEN66106634 Q$="HOW MUCH GOLD?":GOSUB20800:GOSUB170006636 IFC>GD THENQ$="YOU DON'T HAVE THAT MUCH!":GOSUB37000:GOTO66156640 IFC<CZ*50THEN66156645 GD=GD-C:GOSUB203006650 IFRND(0)<C/(GD+C)THEN66606655 Q$="THANK YOU FOR YOUR DONATION":GOSUB37500:GOTO80106660 I=RND(7):IFSF(I)<0THENSF(I)=06665 SF(I)=SF(I)+INT(RND(0)*100*C/(GD+C)+1)6680 Q$="YOU'VE BEEN HEARD":GOSUB37500:GOTO80106700 Q$="FNT":GOSUB40000:GOSUB17000:Q$="YOU HAVE FOUND A FOUNTAIN6702 GOSUB37000:C=RND(5):Q$="WITH RUNNING "+MID$("WHITEBLACKGREENCLEARRED",C*5-4,5)+" WATER6705 GOSUB37000:Q$=U9$+"DRINK SOME":GOSUB37600:IFC$=CHR$(13)THEN67156710 GOSUB17000:GOTO80106715 GOSUB17000:IFRND(0)>.6THEN67506717 IFRND(0)>1-C*.15THEN67306720 Q$=U6$:GOSUB37900:I=RND(3*CZ)6725 Q$="YOU HEAL"+STR$(I)+U1$:CH=CH+1:IFCH>HP THENCH=HP6727 GOSUB20260:GOSUB37500:GOTO80106730 IFRND(0)>.15*C THEN67456735 Q$="IT'S POISON!!":GOSUB37000:I=RND(3*CZ):GOSUB34000:IFCH<1THEN90006742 GOSUB17500:GOTO80106745 GOSUB20100:GOSUB20300:GOSUB17500:GOTO80106750 IFRND(0)>.4THENQ$="YOU FEEL REFRESHED!":GOSUB37500:GOTO80106752 IFRND(0)>.5THEN67806755 IFRND(0)>.5THEN67706760 Q$="MAGICAL POWER SURGES THOUGH YOU":GOSUB37000:CS=CS+RND(4*CZ)6765 Q$="YOU NOW HAVE"+STR$(CS)+" SPELLS":GOSUB20250:GOSUB37500:GOTO80106770 Q$="YOU HAVE BEEN DISPOSESSED!!":FORI=1TO10:I(I)=0:NEXT:GOSUB379006775 GOSUB17500:PCLS1:GOSUB20300:GOSUB15000:GOSUB30025:GOTO80106780 Q$="YOU FEEL REFRESHED!":GOSUB37500:Q$="ACTUALLY YOUR DRUNK!6785 GOSUB37000:IFSF(11)<0THENSF(11)=06786 SF(11)=SF(11)+RND(16):GOSUB15000:GOSUB17000:GOTO80106800 Q$="GCB":GOSUB40000:GOSUB17000:Q$="YOU SEE A LARGE GREY MISTY CUBE6805 GOSUB37000:Q$=U9$+"WALK IN":GOSUB37600:IFCHR$(13)<>C$THEN80106810 IFRND(0)>.2THEN68156812 CZ=RND(50):GOTO68206815 Q$="A NUMBER FROM 1 TO 50":GOSUB20800:IFC$="@"THEN68126817 IFC<1ORC>50THENQ$="NO YOU FOOL!":GOSUB37500:GOTO68106818 CZ=C6820 A=USR5(0):Q$="YOU FLOAT":E=193:GOSUB35010:Q$="IN SPACE...":E=226:GOSUB35010:GOTO20006900 Q$="THR":GOSUB40000:GOSUB17000:Q$="YOU SEE A JEWEL ENCRUSTED THRONE6905 GOSUB37000:Q$="WANT TO <P>RY SOME JEWELS,6910 GOSUB37000:Q$="<S>IT DOWN, <R>EAD THE RUNES,":GOSUB37000:Q$="OR <I>GNORE IT6915 GOSUB37600:IFC$="I"ORC$="@"THENQ$="IGNORE":GOSUB37500:GOTO80106920 IFC$<>"P"THEN69506925 Q$="PRY":GOSUB37500:IFRND(0)>.7THEN70306930 IFRND(0)>.4THEN70256935 Q$="THEY POP INTO YOUR GREEDY HANDS":GOSUB37000:I=INT(RND(1001)*CZ)6940 Q$="THEY ARE WORTH"+STR$(I)+" GOLD":GD=GD+I:GOSUB37300:GOSUB17500:GOTO80106950 IFC$<>"S"THEN69856955 Q$="SIT":GOSUB37500:IFRND(0)>.7THEN70306960 IFRND(0)>.6THEN70256965 IFRND(0)>.4THEN64036970 Q$="A LOUD GONG SOUNDS!":GOSUB37500:IFRND(0)<.5THEN69756973 EX=INT(EX/2):IFLV=1THENEX=-16974 GOSUB18000:GOTO80106975 IFLV>CZ THENQ$=U7$:GOSUB37000:GOTO70106980 EX=1000*2^LV:GOSUB18000:GOTO80106985 IFC$<>"R"THEN70156990 Q$="READ":GOSUB375006992 IFRND(0)>.7THEN70306995 IFRND(0)<ST(1)*.05THEN70057000 Q$="YOU DON'T UNDERSTAND THEM...":GOTO70107005 Q$="A MYSTERIOUS MAGIC GRIPS YOU..":GOSUB37000:GOSUB202007010 GOSUB17500:GOTO80107015 GOTO69007025 Q$=U7$:GOTO70107030 M=RND(20):GOSUB197007032 Q$="THE "+M$+" KING RETURNS!":GOSUB37500:GOSUB207007035 Q$="   ":GOSUB40000:Q$="m":GOSUB40010:ML=RND(CZ*5)+4:GOTO30107100 Q$="SAF":GOSUB40000:GOSUB170007105 Q$="IT'S A SMALL BOX WITH 4 COLORED":GOSUB37000:Q$="LIGHTS. <P>USH OR <I>GNORE":GOSUB376007115 IFC$<>"P"THENQ$="IGNORE":GOSUB37500:GOTO80107120 Q$="PUSH":GOSUB37500:CB=17125 Q$="PUSH <R>ED, <G>REEN, <Y>ELLOW,":GOSUB37000:Q$="<B>LUE, OR <S>TOP7130 GOSUB37600:IFC$="S"ORC$="@"THENQ$="STOP":GOSUB37500:GOTO80107135 FORC=1TO4:IFC$=MID$("RYGB",C,1)THEN71457140 NEXT:GOTO71257145 Q=63910:GOSUB19705:Q$=M$:GOSUB37000:IFC<>B(CB)THEN71707150 CB=CB+1:IFCB<5THENGOSUB17500:GOTO71257155 Q$="IT OPENS!!":GOSUB37500:Q$="INSIDE YOU FIND JEWELS WORTH7160 GOSUB37000:GOSUB19800:I=INT(RND(0)*20000*CZ^2+1):Q$=STR$(I)+" IN GOLD!!":GD=GD+I:GOSUB373007165 GOSUB17000:GOTO80107170 I=RND(6*CZ):Q$="AN ELECTRIC BOLT SHOCKS YOU!!7175 GOSUB37500:GOSUB34000:IFCH<1THEN90007185 GOSUB17500:GOTO80108010 M=0:GOSUB17000:GOSUB16500:Q$="<COMMAND>8020 GOSUB37600:IFC$="@"THENC$="D8100 Q=1:FORC=Q TO20:IFMID$(CM$,C,Q)=C$THEN8117ELSENEXT8115 Q$="NO":GOSUB37000:FORI=1TO300:NEXT:GOTO80108117 IFC>5THENC=C-58118 IFSF(11)>0ANDC<6THENQ$="YOU'RE CONFUSED ??":GOSUB37000:C=RND(5)8120 ONC GOTO8150,8200,8250,8300,8350,8800,8700,8900,8970,8970,8600,8910,8925,89458150 IF(LL AND3)>2ANDSF(8)<1ORCY=1THEN81158155 Q$="NORTH":GOSUB37000:CY=CY-1:GOSUB30100:GOTO20008200 IF(P(2,1)AND3)>2ANDSF(8)<1ORCY=200THEN81158205 Q$="SOUTH":GOSUB37000:CY=CY+1:GOSUB30100:GOTO20008250 IF(INT(LL/4)AND3)>2ANDSF(8)<1ORCX=1THEN81158255 Q$="WEST":GOSUB37000:CX=CX-1:GOSUB30100:GOTO20008300 IF(INT(P(1,2)/4)AND3)>2ANDSF(8)<1ORCX=200THEN81158305 Q$="EAST":GOSUB37000:CX=CX+1:GOSUB30100:GOTO20008350 Q$="STAY":GOSUB37000:Q$="   ":GOSUB40000:GOSUB30000:IFM<>0THEN30108355 SY=0:GOTO20008600 Q$="STORE "+NM$:E=672:GOSUB350008615 VERIFYON:OPEN"O",1,NM$+"/PLR8635 Q$=CHR$(34):PRINT#1,Q$;NM$;Q$:PRINT#1,4.17:FORI=0TO5:PRINT#1,ST(I):NEXT8640 PRINT#1,LV,GD,TG,EX,CH,HP,CX,CY,CZ,SU,CS8650 FORI=1TO10:PRINT#1,I(I),SF(I):NEXT:PRINT#1,SF(11)8655 FORI=1TO20:PRINT#1,FM(I),FL(I),FH(I):NEXT8660 FORI=1TO4:PRINT#1,B(I):NEXT:CLOSE8670 GOSUB17500:IFCZ=0THEN61258675 GOTO80108700 Q$="QUIT - ARE YOU SURE?":GOSUB376008702 IFC$<>"Y"THENQ$="NO":GOSUB37500:GOTO80108710 Q$="YES - GOOD BYE CRUEL WORLD!":GOSUB37900:GOTO90008800 PCLS1:LOADM"H8850 GOSUB16000:IFC$="@"THEN8850ELSEGOSUB17500:PCLS1:GOSUB20300:GOSUB15000:GOSUB30025:GOTO80108900 GOSUB20300:GOSUB15000:GOSUB30025:GOTO80108910 Q$="USE SCROLL OF RESCUE":GOSUB370008915 IFI(8)<1THEN89208917 I(8)=I(8)-1:CX=25:CY=13:CZ=1:Q$="---ZAP!!---":GOSUB37900:GOSUB300258918 GD=0:GOSUB20300:GOTO20008920 Q$="YOU DON'T HAVE ONE!":GOSUB370008922 GOSUB17500:GOTO80108925 Q$="DRINK HEALING POTION":GOSUB37000:IFI(9)<1THEN89208935 I(9)=I(9)-1:GOSUB20300:CH=CH+RND(20):IFCH>HP THENCH=HP8940 Q$=U6$:GOSUB37300:GOTO89228945 Q$="DRINK GIANT STRENGTH":GOSUB37000:IFI(10)<1THEN89208950 IFSF(1)<0THENSF(1)=08955 SF(1)=SF(1)+19+RND(20):Q$="STRENGTH FLOWS THROUGH YOUR BODY8960 I(10)=I(10)-1:GOSUB37300:GOTO89228970 D=0:GOTO210009000 GOSUB17500:Q$="YOU DIED!!":GOSUB375009001 IFSF(10)>0THEN272059002 PCLS1:Q$="ANOTHER NO SO":IFLV>4THENQ$=LEFT$(Q$,7)9005 GOSUB37000:Q$="GREAT ADVENTURER BITS THE DUST9010 GOSUB37000:Q$="DO YOU WANT TO TRY AGAIN?":GOSUB370009012 GOSUB16000:IFC$="Y"THENPCLS1:LOADM"MLSCREEN",32512:RUN9013 IFC$="@"THEN9012ELSEEND10010 Q=X*XO+Y*YO+Z*ZO+(X+XO)*(Y+YO)*(Z+ZO)10020 H=(Q-INT(Q))*WO:IFINT(H/256)>5THENH=H AND25510025 IFINT(H/256)>0THENH=(INT((Q*10-INT(Q*10))*15+1)*256)OR(H AND255)10030 IFX=1ORX=201THENH=H OR1210035 IFY=1ORY=201THENH=H OR310040 RETURN10050 IFW<2THENRETURNELSEE=LL:Q$="@@@@@@":GOSUB35010:IFW>2THENRETURNELSEQ$="@@**@@":GOSUB35010:RETURN10075 IFW<2THENRETURNELSEFORQ=0TO128STEP32:E=LL+Q:Q$="@":GOSUB35010:NEXT:IFW>2THENRETURNELSEFORX=1TO3:E=LL+32*X:Q$=CHR$(X+34):GOSUB35010:NEXT:RETURN15000 Z=CZ:FORQ2=0TO3:Y=CY+Q2-1:FORQ1=0TO3:X=CX+Q1-1:GOSUB1001015005 P(Q2,Q1)=H:NEXT:NEXT:A=USR5(0)15006 A=USR5(0)15007 N$="":FORI=1TO1115008 IFSF(I)<1THEN1501015009 N$=N$+MID$("STRGDTRPLGHTPROTLEVTINVSFEARASTWTMSTRSEDDRNK",I*4-3,4)+":"15010 NEXT:IFLEN(N$)>30THENQ$=RIGHT$(N$,LEN(N$)-30):C$=LEFT$(N$,30):GOSUB37000:N$=C$15011 GOSUB38000:IF(P(1,1)AND3)>1OR(INT(P(0,1)/4)AND3)>1THEN1501515012 LL=64:W=(P(0,0)AND3):GOSUB1005015015 IF(P(1,0)AND3)>1OR((INT(P(1,1))/4)AND3)>1THEN1502515020 LL=64:W=(INT(P(0,0)/4)AND3):GOSUB1007515025 IF(P(1,1)AND3)>1THEN1504015030 LL=69:W=(P(0,1)AND3):GOSUB10050:W=(INT(P(0,1)/4)AND3):GOSUB1007515035 LL=74:W=(INT(P(0,2)/4)AND3):GOSUB1007515040 IF(P(1,1)AND3)>1OR(INT(P(0,2)/4)AND3)>1THEN1504515042 LL=74:W=P(0,2)AND3:GOSUB1005015045 IF(INT(P(1,2)/4)AND3)>1OR(P(1,2)AND3)>1THEN1505515050 LL=79:W=INT(P(0,3)/4)AND3:GOSUB1007515055 IF(INT(P(1,2)/4)AND3)>1THEN1508015060 LL=202:W=(P(1,2)AND3):GOSUB10050:LL=207:W=INT(P(1,3)/4)AND3:GOSUB1007515070 LL=330:W=P(2,2)AND3:GOSUB1005015080 IF(P(2,1)AND3)>1OR(INT(P(2,2)/4)AND3)>1THEN1508515082 LL=458:W=P(3,2)AND3:GOSUB1005015085 IF(INT(P(1,2)/4)AND3)>1OR(P(2,2)AND3)>1THEN1510015090 LL=335:W=(INT(P(2,3)/4)AND3):GOSUB1007515100 IF(P(2,1)AND3)>1THEN1512015105 LL=330:W=INT(P(2,2)/4)AND3:GOSUB1007515110 LL=453:W=P(3,1)AND3:GOSUB10050:LL=325:W=INT(P(2,1)/4)AND3:GOSUB1007515120 IF(P(2,1)AND3)>1OR(INT(P(2,1)/4)AND3)>1THEN1512515122 LL=448:W=P(3,0)AND3:GOSUB1005015125 IF(INT(P(1,1)/4)AND3)>1OR(P(2,0)AND3)>1THEN1514015130 LL=320:W=INT(P(2,0)/4)AND3:GOSUB1007515140 IF(INT(P(1,1)/4)AND3)>1THEN1515515145 LL=320:W=P(2,0)AND3:GOSUB1005015150 LL=192:W=INT(P(1,0)/4)AND3:GOSUB10075:W=P(1,0)AND3:GOSUB1005015155 LL=197:W=INT(P(1,1)/4)AND3:GOSUB10075:W=P(1,1)AND3:GOSUB1005015160 LL=202:W=INT(P(1,2)/4)AND3:GOSUB10075:LL=325:W=P(2,1)AND3:GOSUB1005015200 E=263:Q$="[":GOSUB35010:LL=P(1,1):IFSF(3)<=0THENRETURN15300 Q$="*":U=P(0,0):QQ=P(1,0):K=P(1,1):C=K:X=P(0,1):Q=X:I=K:E=130:J=135:GOSUB1544515310 U=P(0,2):QQ=K:K=U:C=P(1,2):X=C:Q=C:I=C:E=140:J=268:GOSUB1544015320 U=P(2,2):QQ=U:K=C:C=P(2,1):X=U:Q=C:I=C:E=396:J=391:GOSUB1544515330 U=P(2,0):QQ=U:K=P(1,1):X=C:Q=P(1,0):I=K:E=386:J=258:GOSUB15440:RETURN15420 IFINT(U/256)=0THENRETURN15425 IF(QQ AND3)<2AND(INT(K/4)AND3)<2THEN1543515430 IF(C AND3)>1OR(INT(X/4)AND3)>1THENRETURN15435 GOSUB3501015438 RETURN15440 GOSUB15420:IFINT(Q/256)<>0AND(INT(I/4)AND3)<2THENE=J:GOSUB3501015445 GOSUB15420:IFINT(Q/256)<>0AND(I AND3)<2THENE=J:GOSUB3501015499 RETURN16000 FORQ=1TO400:C$=INKEY$:IFC$<>""THENRETURN16005 NEXT16010 C$="@":RETURN16500 LN=1:RETURN17000 POKE64400,241:A=USR7(0):POKE64400,240:LN=1:RETURN17500 GOSUB19000:GOTO1700018000 IFEX<1000*2^LV THEN1804018010 GOSUB17000:Q$="YOU WENT UP A LEVEL!":LV=LV+1:J=RND(ST(3))18015 CH=CH+J:HP=HP+J:IFEX>1000*2^LV THENEX=1000*2^LV-118017 CS=CS+LV:SU=SU+LV18020 GOSUB37300:GOSUB17500:Q$=U3$+STR$(J)+U1$:GOSUB37000:RETURN18040 IFLV=1ANDEX>=0THENRETURN18050 IFEX>1000*2^(LV-1)THENRETURN18055 CS=CS-LV:SU=SU-LV:IFCS<0THENCS=018060 Q$="YOU GO DOWN A LEVEL!":LV=LV-1:J=RND(ST(3))18065 CH=CH-J:HP=HP-J18070 GOSUB37300:Q$=U4$+STR$(J)+U1$:GOSUB3750018075 IFCH>0ANDLV>0THENRETURN18080 GOSUB19000:GOTO900019000 FORQ=1TO999:NEXT:RETURN19500 FORQ=1TO124:NEXT:RETURN19700 Q=63480:C=M19705 M$="":FORX=0TO7:I=PEEK(Q+C*8+X):IFI=32THENRETURNELSEM$=M$+CHR$(I):NEXT19710 RETURN19800 FORQ=1TO4:B(Q)=RND(4):NEXT:RETURN20000 D=INT(RND(0)*L*6+1):Q$=U8$+STR$(D)+U1$:CH=CH-D:GOSUB3700020005 IFCH>0THENGOSUB20260:RETURN20010 Q$="YOUR LIFE HAS BEEN TERMINATED":GOSUB37300:GOSUB17500:GOTO900020100 I=INT(RND(0)*500*CZ+1)20110 IFRND(0)>.5THENQ$=U4$+STR$(I)+U2$:X=-I:GOTO2012020115 Q$=U3$+STR$(I)+U2$:X=I:EX=EX+X:GOSUB37000:GOSUB18000:RETURN20120 EX=EX+X:GOSUB18000:RETURN20200 I=RND(6)-1:IFRND(0)>.5THEN2022020210 IFST(I)=18THEN2020020215 Q$="YOUR "+MID$(S$,I*3+1,3)+" GOES UP BY 1":ST(I)=ST(I)+1:GOTO2024020220 IFST(I)=3THEN2020020225 Q$="YOUR "+MID$(S$,I*3+1,3)+" GOES DOWN BY 1":ST(I)=ST(I)-120240 GOSUB37300:GOSUB19000:RETURN20250 EN=2:GOTO2032020260 EN=3:GOTO2032020300 EN=120301 E=0:Q$=NM$:GOSUB35000:E=9:Q$=" LVL"+STR$(LV):GOSUB3500020302 E=-7:FORX=0TO2:E=E+24:Q$=MID$(S$,X*6+1,3)+STR$(ST(X*2)):GOSUB35000:E=E+8:Q$=MID$(S$,X*6+4,3)+STR$(ST(X*2+1)):GOSUB35000:NEXT20320 E=113:Q$="HP"+STR$(CH)+"/"+MID$(STR$(HP),2):GOSUB3500020321 IFEN=3THENRETURN20322 E=32:Q$="SU"+STR$(CS)+"/"+MID$(STR$(SU),2):GOSUB3500020323 IFEN=2THENRETURN20325 E=145:Q$="EXP"+STR$(INT(EX)):GOSUB3500020330 E=177:Q$="GLD"+STR$(GD):GOSUB3500020335 A=USR2(0):QQ=0:FORI=1TO10:IFI<4THENIFI(I)>0THEN2034520340 IFI(I)<1THEN2038020345 QQ=QQ+1:E=QQ*32+176:IFI>7THEN2036520350 Q$=" "+MA$(I):IFI(I)>0THENQ$=" "+MA$(I)+" +"+MID$(STR$(I(I)),2)20351 GOSUB35000:GOTO2038020365 Q$=STR$(I(I))+" "+MA$(I):GOSUB3500020380 NEXT20398 RETURN20600 E=480:Q$=STRING$(17,32):GOSUB35010:GOSUB17000:Q$=" ":GOSUB40010:RETURN20700 UN=0:IFM=3ORM=5ORM=8ORM=10ORM=13ORM=17ORM=18THENUN=120705 RETURN20800 GOSUB37000:E=512+LN*32:GOSUB36000:C=VAL(N$):RETURN20900 GOSUB16500:Q$="YOU HAVE NOT BEEN NOTICED...":GOSUB3700020905 Q$=U9$+"APPROACH":GOSUB3760020910 IFC$=CHR$(13)THENGOSUB17000:GOTO300720915 Q$=" ":GOSUB40010:GOSUB17000:GOTO400021000 Q$="CAST":GOSUB37000:Q$="SPELL LEVEL":GOSUB37600:C=VAL(C$):Q$=C$:GOSUB3700021002 IFC>0ANDC<=INT(LV/3)+1ANDC<7THEN2101021004 IFC=0THEN2191021005 Q$="YOU HAVEN'T THAT LEVEL SPELLS!":GOSUB37900:GOTO2191021010 IFC>CS THENQ$="DON'T HAVE ENOUGH SPELL UNITS!":GOTO2190021020 Q$="SPELL NUMBER? ('L' TO LIST)":GOSUB37600:IFC$=CHR$(13)ORC$="@"THEN2191021025 IFC$<"1"ORC$>"6"THENC$="L"21030 IFC$="L"THEN2104021035 CS=CS-C:GOSUB20250:GOTO2105021040 GOSUB17000:FORI=1TO6:Q$=STR$(I)+". "+SP$(I+6*(C-1)):GOSUB37000:NEXT21046 Q$=U9$+"CONTINUE...":GOSUB37600:GOSUB1700021047 IFC$<"1"ORC$>"6"THEN2102021048 GOTO2103521050 S=VAL(C$):ONC GOTO22000,23000,24000,25000,26000,2700021700 MH=MH-I:Q$="IT SUFFERS"+STR$(I)+U1$:IFMH>0THEN2190021705 GOSUB37000:GOTO322021750 Q$="NOT IN MELEE!!":GOSUB37500:GOTO330021800 Q$="YOU JUST WASTED A COMBAT SPELL!21900 GOSUB37500:IFD=1THEN330021905 GOTO801021910 GOSUB17000:IFD=1THEN310021915 GOTO801021920 GOSUB17500:GOSUB20600:GOTO400021930 Q$="UNDEAD ARE ALREADY DEAD!":GOTO2190022000 ONS GOTO22100,22200,22300,22400,22500,2260022100 Q$=SP$(1):GOSUB37500:Q$=">>>ZZZAAAPPP<<<":GOSUB37000:IFD=0THEN2180022105 I=RND(8)+4:GOTO2170022200 Q$=SP$(2):GOSUB37500:IFD=0THEN2180022202 IFUN=1THENQ$="UNDEAD DON'T SLEEP!":GOTO3330022205 IFRND(20)>ST(1)THENQ$="THE "+M$+" ISN'T SLEEPY!":GOTO3330022210 Q$="THE "+M$+" IS SLEEPING!":GOSUB37000:GOSUB3300022215 IFC$<>CHR$(13)THENGOSUB17000:GOTO371022220 IFRND(0)>.2THEN322022225 Q$="IT WOKE UP!!":GOSUB37900:GOTO330022300 Q$=SP$(3):GOSUB37000:I=RND(8):GOTO3200022400 S=4:T=3:U=1122402 Q$=SP$(S):GOSUB37000:IFSF(T)<0THENSF(T)=022405 SF(T)=SF(T)+RND(U)+4:GOTO3190022500 Q$=SP$(5):GOSUB37500:IFD=0THEN2180022505 IFUN=1THEN2251522510 Q$="THE "+M$+" IS INSULTED":GOSUB37000:Q$="AT BEING CALLED UNDEAD":GOTO2190022515 IFRND(0)<.05*ST(2)+.05*LV-.05*ML THEN2252522520 Q$="THE "+M$+" LISTENS WITH DEAF EARS":GOTO2190022525 ML=INT((ML/2)+.5):Q$="IT RUNS IN FEAR!!":GOSUB37000:GOTO322322600 S=6:T=4:U=11:GOTO2240223000 ONS GOTO23100,23200,23300,23400,23500,2360023100 Q$=SP$(7):GOSUB37500:IFD=0THEN2180023105 IFINT(RND(0)^2*20+ML)>ST(1)THENQ$="THE "+M$+" DODGES ASIDE!":GOTO3330023110 Q$="THE "+M$+" IS WEBBED!":GOSUB37000:GOSUB3300023115 IFC$<>CHR$(13)THENGOSUB17000:GOTO371023120 IFRND(0)-ML/20>.2THEN322023125 Q$="IT BROKE FREE!!":GOSUB37900:GOTO330023200 S=8:T=5:U=21:GOTO2240223300 Q$=SP$(9):GOSUB37500:IFD=0THEN2180023305 I=INT(RND(0)*12+3):GOTO2170023400 S=10:T=2:U=21:GOTO2240223500 Q$=SP$(11):GOSUB37500:IFD=0THEN2180023502 IFUN=1THENQ$="THE UNDEAD IGNORE YOUR WILES!":GOTO3330023505 IFINT((RND(0)^2)*20+1)>ST(5)THENQ$="THE "+M$+" RESISTS YOU!":GOTO3330023510 Q$="THE "+M$+" IS CHARMED":GOSUB37000:GOSUB3300023515 GOTO2311523600 S=12:T=1:U=21:GOTO2240224000 ONS GOTO24100,24200,24300,24400,24500,2460024100 Q$=SP$(13):GOSUB37500:Q$="CRRRAAACKKK!!":GOSUB37000:IFD=0THEN2180024105 GOSUB19000:I=INT(RND(0)*6*LV+15):GOTO2170024200 Q$=SP$(14):GOSUB37000:I=INT(RND(0)*24+1):GOTO3200024205 IFCH>HP THENCH=HP24300 S=15:T=3:U=51:GOTO2240224400 S=16:T=6:U=21:GOTO2240224500 Q$=SP$(17):GOSUB37500:IFD=0THEN2180024505 IFINT(RND(0)*20+ML)>ST(1)THENQ$="THE "+M$+" IGNORES YOU!":GOTO3330024510 Q$="THE "+M$+" IS HELD":GOSUB37000:GOSUB3300024515 IFC$<>CHR$(13)THENGOSUB17000:GOTO371024520 IFRND(0)>.2+ML*.03THEN322024525 GOTO2312524600 Q$=SP$(18):GOSUB37500:IFD=0THEN2180024605 IFRND(21)+ML<ST(1)THEN2461524610 Q$="THE "+M$+" DOESN'T BELIEVE!":GOTO3330024615 Q$="IT BELIEVES!...ARRGH...":GOSUB37000:GOTO322025000 ONS GOTO25100,25200,25300,25400,25500,2560025100 Q$=SP$(19):GOSUB37500:IFD=1THEN2175025105 Q$="DIRECTION ->":GOSUB37000:GOSUB1600025110 FORI=1TO10:IFMID$(CM$,I,1)=C$THEN2511725115 NEXT:GOTO2510525117 IFI>5THENI=I-525118 IFI=5THEN3190025120 IF(I=1ANDCY>1)OR(I=2ANDCY<200)OR(I=3ANDCX>1)OR(I=4ANDCX<200)THEN2512525122 GOTO2613025125 GOSUB30200:Q$="---POOF---":GOSUB37000:ONI GOTO8155,8205,8255,830525200 Q$=SP$(20):GOSUB37500:Q$="WHOOOOSHH!!":GOSUB37000:IFD=0THEN2180025205 Q$="THE "+M$+" IS BURNING!":I=INT(RND(0)*12*LV+15):GOSUB37900:GOTO2170025300 Q$=SP$(21):GOSUB37500:IFD=0THEN2180025305 I=INT(RND(0)*32+10):GOTO2170025400 Q$=SP$(22):GOSUB37500:IFD=0THEN2180025405 IFRND(0)>.6THENQ$="THE "+M$+" ISN'T AFFECTED":GOTO3330025410 Q$="ONE STONE STATUE...":GOSUB37000:GOTO322025500 S=23:T=7:U=30:GOTO2240225600 Q$=SP$(24):GOSUB37500:Q$="DIE!!!!":GOSUB37000:IFD=0THEN2180025603 IFUN=1THEN2193025605 GOSUB19000:IFRND(0)>.3+ML*.4-LV*.03THEN322025610 Q$="THE "+M$+" LAUGHS":GOSUB37500:GOTO330026000 ONS GOTO26100,26200,26300,26400,26500,2660026100 Q$=SP$(25):GOSUB37500:IFD=1THEN2175026105 Q$="+NORTH/-SOUTH":GOSUB20800:NY=C:LN=LN+1:Q$="+EAST/-WEST":GOSUB2080026110 NX=C:LN=LN+1:Q$="+UP/-DOWN":GOSUB20800:NZ=C:LN=LN+1:I=SQR(NX^2+NY^2+(NZ*5)^2)-.126115 IFI>LV*5THENQ$="TOO FAR...TRY AGAIN":GOSUB37500:GOTO2610526120 NX=CX+NX:NY=CY-NY:NZ=CZ-NZ26125 IFNX>0ANDNX<201ANDNY>0ANDNY<201ANDNZ<51THEN2613526130 Q$="ONLY STONE THERE...SPELL FAILS":GOTO2190026135 IFNZ<1THENQ$="ONLY THIN AIR...THE SPELL FAILS":GOTO2190026140 CX=NX:CY=NY:CZ=NZ:Q$="----POOF----":GOSUB37000:GOSUB30200:GOTO200026200 S=26:T=8:U=16:GOTO2240226300 Q$=SP$(27):GOSUB37500:IFD=0THEN2180026305 Q$="QWERTY!!!":GOSUB37900:IFRND(4)<3THEN322026310 Q$="THE "+M$+" DOESN'T HEAR...":GOTO2190026400 Q$=SP$(28):GOSUB37500:IFD=0THEN2180026405 Q$="BRRRRRR!!":GOSUB37000:I=60:GOTO2170026500 Q$=SP$(29):GOSUB37500:Q$="*":GOSUB40010:GOSUB17000:Q$="WWHHOOOOSSHH!!":GOSUB3700026505 Q$="A WALL OF FIRE SURROUNDS YOU!":GOSUB37900:GOSUB1750026507 IFD=0THEN2180026510 Q$=" ":GOSUB40010:GOSUB17000:IFRND(0)>.4THEN3100026515 Q$="THE "+M$+" WALKS THROUGH!!":GOSUB37000:I=RND(12)+7:GOTO2170026600 Q$=SP$(30):GOSUB37500:IFD=0THEN2180026605 IFUN=1THEN2193026610 Q$="BLACK DEATH FOR THE "+M$26615 GOSUB37500:IFRND(0)>ST(2)*.05THENQ$="IT IS IMMUNE!!":GOTO2190026620 IFRND(0)*2<ST(3)*.03+1THEN322026625 Q$="THE SPELL BACKFIRES!!":GOSUB37500:GOTO900027000 ONS GOTO27100,27200,27300,27400,27500,2760027100 S=31:T=9:U=20:GOTO2240227200 S=32:T=10:U=40:GOTO2240227205 Q$=SP$(32):GOSUB37500:ST(3)=ST(3)-127207 SF(10)=0:IFRND(0)>ST(3)*.06THEN2722027210 Q$="IT WORKS!!":CH=HP:GOSUB20300:GOTO2190027220 Q$="IT DOESN'T WORK!":GOSUB37000:GOTO900027300 Q$=SP$(33):GOSUB37500:IFD=0THEN2180027305 FORU=1TO9:Q$=MID$(".,+&^O0* ",U,1):GOSUB40010:GOSUB19500:NEXT27307 GOSUB19000:IFRND(0)<.9THEN322027310 Q$="THE "+M$+" DOESN'T SEE...":GOTO2190027400 Q$=SP$(34):GOSUB37500:IFD=1THEN2175027405 FORI=0TO10:I(I)=0:NEXT:GD=0:PCLS1:GOSUB20300:GOSUB3020027410 CX=25:CY=13:CZ=1:Q$="ZAP!":GOSUB40000:GOSUB19000:GOTO200027500 Q$=SP$(35):GOSUB37500:I=100000:GOTO3200027600 Q$=SP$(36):GOSUB37500:Q$="A SHIFTING MULTI-COLORED WALL":GOSUB37000:Q$="APPEARS27605 GOSUB37000:IFD=0THEN2180027610 FORJ=1TO16:Q$="*":GOSUB40010:GOSUB19500:Q$=" ":GOSUB40010:GOSUB19500:NEXT27615 GOSUB17000:Q$="THE "+M$+" IS GONE":GOTO2192030000 M=0:IFFM(1)=0THEN3002030010 M=FM(1):ML=FL(1):MH=FH(1):GOSUB2070030020 FORI=1TO19:FM(I)=FM(I+1):FH(I)=FH(I+1):FL(I)=FL(I+1):NEXT30022 FM(20)=0:FL(20)=0:FH(20)=0:IFM<>0THENQ$="m":GOSUB4001030025 E=48:FORQ=1TO11:E=E+32:IFFM(Q)=0THENQ$=" ":GOSUB35010:GOTO3004030030 Q$="_":GOSUB3501030040 NEXT:RETURN30100 FORQ=19TO1STEP-1:FM(Q+1)=FM(Q):FL(Q+1)=FL(Q):FH(Q+1)=FH(Q):NEXT30105 IFM=0THENFM(1)=0:FL(1)=0:FH(1)=0:GOTO3002530110 FM(1)=M:FL(1)=ML:FH(1)=MH:GOTO3002530200 FORQ=1TO20:FM(Q)=0:FL(Q)=0:FH(Q)=0:NEXT:GOTO3002531000 Q$="THE "+M$+" IS GONE":GOSUB37000:GOTO2192031900 GOSUB17500:IFD=1THEN3300ELSE801032000 Q$=U6$:CH=CH+I:IFCH>HP THENCH=HP32010 GOSUB20260:GOTO2190033000 Q$="PRESS "+U9$+"KILL":GOSUB37600:RETURN33300 GOSUB37000:GOTO330034000 Q$=U8$+STR$(I)+U5$:GOSUB37000:CH=CH-I:GOSUB20260:RETURN35000 Q$=Q$+"     ":GOSUB3501035010 A=USR4(0):A=USR8(INT(E)):Q$=USR9(Q$):RETURN36000 N$="":Q$="      ":GOSUB3500036005 GOSUB16000:I=ASC(C$):IFI=8ORI=12THEN36000ELSEIFI=64THEN36005ELSEIFI=13THENRETURNELSEIFI>90THEN36005ELSEN$=N$+C$:Q$=N$:GOSUB35000:IFLEN(N$)=8THENRETURNELSE3600537000 Q$=Q$+"              ":E=512+LN*32:IFE<746THENLN=LN+1:GOTO3701037005 E=736:A=USR6(0)37010 GOSUB35010:RETURN37300 GOSUB37000:GOSUB20300:RETURN37500 GOSUB37000:GOSUB17500:RETURN37600 GOSUB37000:GOSUB16000:RETURN37700 GOSUB37000:GOSUB17000:RETURN37900 GOSUB37000:GOSUB19000:RETURN38000 LN=0:Q$=N$+STRING$(32,32):GOSUB3700038010 RETURN39000 FORX=0TO2:M$="":FORQ=0TO8:I=PEEK(Q+X*90+Q(X+1)*9+63639):IFI=32THENNEXT:ELSEM$=M$+CHR$(I):NEXT39010 N$(X+1)=M$+" ":NEXT:RETURN40000 LINE(79,55)-(47,55),PSET:LINE-(47,64),PSET:E=230:GOSUB35010:RETURN40010 E=264:GOSUB35010:RETURN