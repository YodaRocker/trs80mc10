2000 '** EQUIPMENT STORE **2010 CLS2020 GOSUB 38902030 PRINT@2,"WELCOME TO BORRIC'S SHOPPE!";2040 FOR Y=65TO449STEP32:PRINT@Y,STRING$(13,128);:NEXT Y2050 PRINT@33,STRING$(13,156);:PRINT@449,STRING$(13,147);2060 FORY=32TO448STEP32:PRINT@Y,CHR$(159);:PRINT@Y+14,CHR$(159);:NEXT Y2070 PRINT@336,"USE ARROW KEYS";:PRINT@368,"TO SELECT ITEM.";:PRINT@400,"<P> TO PURCHASE";:PRINT@432,"<S> TO SELL";:PRINT@464,"<D> WHEN DONE";2080 PRINT@81,"WEAPONS LIST";:PRINT@113,"--===++===--";2090 PRINT@144,"DAGGER     2 GP";:PRINT@176,"CLUB       4 GP";:PRINT@208,"HAND AXE   6 GP";:PRINT@240,"MACE       8 GP";2100 PRINT@272,"SWORD     10 GP";2110 PRINT@480,"GOLD PIECES:";GP;2120 Y=1442130 PRINT@144,"dagger";STRING$(5,128);:POKE1024+155,50:PRINT@156,CHR$(128);"gp";:GOSUB 22902140 I$=INKEY$:IF I$="" THEN 21402150 PRINT@480,"GOLD PIECES:";GP;2160 PRINT@144,"DAGGER     2 GP";:PRINT@176,"CLUB       4 GP";:PRINT@208,"HAND AXE   6 GP";:PRINT@240,"MACE       8 GP";2170 PRINT@272,"SWORD     10 GP";2180 IF I$=CHR$(10) THEN Y=Y+32:IF Y>272 THEN Y=1442190 IF I$=CHR$(94) THEN Y=Y-32:IF Y<144 THEN Y=2722200 IF I$="D" THEN 30502210 IF I$="P" THEN GOSUB 2750:I$="":GOTO21502220 IF I$="S" THEN GOSUB 2970:I$="":GOTO21502230 IF Y=144 THEN PRINT@Y,"dagger";STRING$(5,128);:POKE1024+155,50:PRINT@156,CHR$(128);"gp";:GOSUB 22902240 IF Y=176 THEN PRINT@Y,"club";STRING$(7,128);:POKE1024+187,52:PRINT@188,CHR$(128);"gp";:GOSUB 23602250 IF Y=208 THEN PRINT@Y,"hand";CHR$(128);"axe";STRING$(3,128);:POKE1024+219,54:PRINT@220,CHR$(128);"gp";:GOSUB 24302260 IF Y=240 THEN PRINT@Y,"mace";STRING$(7,128);:POKE1024+251,56:PRINT@252,CHR$(128);"gp";:GOSUB 25102270 IF Y=272 THEN PRINT@Y,"sword";STRING$(5,128);:POKE1024+282,49:POKE1024+283,48:PRINT@284,CHR$(128);"gp";:GOSUB26102280 GOTO 21402290 '** DISPLAY DAGGER **2300 GOSUB 26802310 FORX=135TO231STEP32:PRINT@X,CHR$(218);:NEXTX:FORX=166TO230STEP32:PRINT@X,CHR$(223);:NEXTX:FORX=168TO232STEP32:PRINT@X,CHR$(223);:NEXTX2320 PRINT@134,CHR$(209);:PRINT@136,CHR$(210);2330 PRINT@260,STRING$(2,156);STRING$(3,159);STRING$(2,156);:PRINT@294,STRING$(3,255);:PRINT@326,STRING$(3,255);2340 PRINT@227,CHR$(145);:PRINT@235,CHR$(146);2350 PRINT@358,CHR$(156);CHR$(159);CHR$(156);:RETURN2360 '** DISPLAY CLUB **2370 GOSUB 26802380 FORX=102TO390STEP32:PRINT@X,STRING$(3,255);:NEXT X:FORX=105TO265STEP32:PRINT@X,CHR$(255);:NEXTX:FORX=133TO229STEP32:PRINT@X,CHR$(255);:NEXTX2390 FORX=138TO234STEP32:PRINT@X,CHR$(255);:NEXTX:PRINT@101,CHR$(241);:PRINT@106,CHR$(242);2400 PRINT@261,CHR$(244);:PRINT@266,CHR$(248);:PRINT@392,CHR$(254);:PRINT@134,CHR$(246);:PRINT@166,CHR$(251);:PRINT@168,CHR$(254);CHR$(247);2410 PRINT@200,CHR$(247);:PRINT@230,CHR$(251);CHR$(253);:PRINT@233,CHR$(251);:PRINT@296,CHR$(245);:PRINT@327,CHR$(251);:PRINT@358,CHR$(251);2420 RETURN2430 '** DISPLAY HAND AXE **2440 GOSUB 26802450 PRINT@68,STRING$(3,243);:FORX=196TO388STEP32:PRINT@X,STRING$(3,255);:NEXTX:FORX=99TO163STEP32:PRINT@X,CHR$(213);:NEXTX2460 FORX=100TO164STEP32:PRINT@X,STRING$(8,223);:NEXTX:PRINT@73,STRING$(3,211);2470 PRINT@201,STRING$(2,220);:PRINT@203,CHR$(223);:PRINT@107,CHR$(222);:PRINT@171,CHR$(222);2480 PRINT@196,CHR$(254);:PRINT@228,CHR$(251);:PRINT@229,CHR$(253);:PRINT@294,CHR$(245);:PRINT@325,CHR$(254);2490 PRINT@357,CHR$(247);:PRINT@390,CHR$(247);:PRINT@420,CHR$(204);:PRINT@421,CHR$(207);:PRINT@422,CHR$(204);2500 RETURN2510 '** DISPLAY MACE **2520 GOSUB 26802530 FOR X=262TO390STEP32:PRINT@X,STRING$(3,255);:NEXTX:FORX=101TO197STEP32:PRINT@X,STRING$(5,223);:NEXTX2540 PRINT@100,CHR$(211);:PRINT@132,CHR$(223);:PRINT@164,CHR$(223);:PRINT@196,CHR$(220);:PRINT@131,CHR$(223);:PRINT@163,CHR$(223);2550 PRINT@130,CHR$(209);:PRINT@162,CHR$(212);:PRINT@70,CHR$(211);CHR$(223);CHR$(211);2560 PRINT@106,CHR$(211);:PRINT@138,CHR$(223);CHR$(223);CHR$(210);:PRINT@170,CHR$(223);CHR$(223);CHR$(216);:PRINT@202,CHR$(220);2570 PRINT@230,STRING$(3,223);:PRINT@102,CHR$(217);:PRINT@133,CHR$(217);:PRINT@165,CHR$(219);CHR$(221);:PRINT@198,CHR$(219);2580 PRINT@104,CHR$(214);:PRINT@137,CHR$(214);:PRINT@168,CHR$(222);CHR$(215);:PRINT@200,CHR$(215);2590 PRINT@422,CHR$(236);CHR$(239);CHR$(236);:PRINT@262,CHR$(254);:PRINT@295,CHR$(247);:PRINT@327,CHR$(250);:PRINT@360,CHR$(253);:PRINT@391,CHR$(251);2600 RETURN2610 '** DISPLAY SWORD **2620 GOSUB 26802630 FORX=134TO294STEP32:PRINT@X,STRING$(2,223);CHR$(213);CHR$(218);:NEXTX:PRINT@102,CHR$(215);CHR$(223);CHR$(213);CHR$(210);:PRINT@71,CHR$(215);2640 PRINT@291,CHR$(177);:PRINT@299,CHR$(177);:PRINT@324,STRING$(2,188);STRING$(3,191);CHR$(190);CHR$(188);CHR$(184);2650 PRINT@358,STRING$(3,255);CHR$(250);:PRINT@390,STRING$(3,255);CHR$(250);2660 PRINT@422,CHR$(188);CHR$(189);CHR$(188);CHR$(184);2670 RETURN2680 '** CLEAR DISPLAY **2690 FOR X=65TO417STEP32:PRINT@X,STRING$(13,128);:NEXTX:RETURN2700 '** BUY ITEM **2710 'BS$=""2720 'FOR X=226TO236:BS$=BS$+CHR$(PEEK(1024+X)):NEXT X2730 T$="A VERY FINE CHOICE, SIR!":GOSUB 2840:RETURN2740 GOTO 27402750 '** PURCHASE WEAPON **2760 IF W$<>"HAN" THEN T$="YOU ALREADY HAVE A WEAPON!":GOSUB 2840:RETURN2770 IF Y=144 AND GP>=2 THEN GOSUB 2700:GP=GP-2:W$="DAG":RETURN2780 IF Y=176 AND GP>=4 THEN GOSUB 2700:GP=GP-4:W$="CLU":RETURN2790 IF Y=208 AND GP>=6 THEN GOSUB 2700:GP=GP-6:W$="AXE":RETURN2800 IF Y=240 AND GP>=8 THEN GOSUB 2700:GP=GP-8:W$="MAC":RETURN2810 IF Y=272 AND GP>=10 THEN GOSUB 2700:GP=GP-10:W$="SWO":RETURN2820 T$="NOT ENOUGH GOLD!":GOSUB 28402830 RETURN2840 '** WINDOW SUBROUTINE **2850 W1$="":W2$="":W3$="":L=LEN(T$)2860 A=192+((32-L)/2):FORX=(A-2)TO(A+L+1):P=PEEK(1024+X):IF P=96 THEN P=1432870 W1$=W1$+CHR$(P):NEXTX2880 A=224+((32-L)/2):FORX=(A-2)TO(A+L+1):P=PEEK(1024+X):IF P=96 THEN P=1432890 W2$=W2$+CHR$(P):NEXT X2900 A=256+((32-L)/2):FORX=(A-2)TO(A+L+1):P=PEEK(1024+X):IF P=96 THEN P=1432910 W3$=W3$+CHR$(P):NEXT X2920 PRINT@(192+((32-L)/2)-2),CHR$(129);STRING$(L+2,131);CHR$(130);2930 PRINT@(224+((32-L)/2)-2),CHR$(133);" ";T$;" ";CHR$(138);2940 PRINT@(256+((32-L)/2)-2),CHR$(132);STRING$(L+2,140);CHR$(136);2950 IF INKEY$="" THEN 2950 ELSE 29602960 PRINT@(192+((32-L)/2)-2),W1$;:PRINT@(224+((32-L)/2)-2),W2$;:PRINT@(256+((32-L)/2)-2),W3$;:RETURN2970 '** SELL THE WEAPON **2980 IF W$="HAN" THEN T$="YOU HAVE NO WEAPON!":GOSUB2840:RETURN2990 IF Y=144 AND W$="DAG" THEN GP=GP+1:T$="THANK YOU, SIR!":GOSUB 2840:W$="HAN":RETURN3000 IF Y=176 AND W$="CLU" THEN GP=GP+2:T$="THANK YOU, SIR!":GOSUB 2840:W$="HAN":RETURN3010 IF Y=208 AND W$="AXE" THEN GP=GP+3:T$="THANK YOU, SIR!":GOSUB 2840:W$="HAN":RETURN3020 IF Y=240 AND W$="MAC" THEN GP=GP+4:T$="THANK YOU, SIR!":GOSUB 2840:W$="HAN":RETURN3030 IF Y=272 AND W$="SWO" THEN GP=GP+5:T$="THANK YOU, SIR!!":GOSUB 2840:W$="HAN":RETURN3040 T$="YOU DO NOT HAVE THAT, SIR!":GOSUB2840:RETURN3050 '** ARMOUR **3060 PRINT@81,"ARMOURS";:GOSUB 2680:Y=1443070 PRINT@144,"SHIELD    10 GP";:PRINT@176,"LEATHER   20 GP";:PRINT@208,"CHAINMAIL 40 GP";:PRINT@240,"PLATEMAIL 60 GP";:PRINT@272,STRING$(15,32);3080 PRINT@144,"shield";STRING$(4,128):POKE1024+154,49:POKE1024+155,48:PRINT@156,CHR$(128);"gp";:GOSUB 32203090 I$=INKEY$:IF I$="" THEN 30903100 PRINT@480,"GOLD PIECES:";GP;3110 IF I$="D" THEN 38103120 IF I$="S" THEN GOSUB 37103130 IF I$="P" THEN GOSUB 36103140 PRINT@144,"SHIELD    10 GP";:PRINT@176,"LEATHER   20 GP";:PRINT@208,"CHAINMAIL 40 GP";:PRINT@240,"PLATEMAIL 60 GP";3150 IF I$=CHR$(10) THEN Y=Y+32:IF Y>240 THEN Y=1443160 IF I$=CHR$(94) THEN Y=Y-32:IF Y<144 THEN Y=2403170 IF Y=144 THEN PRINT@144,"shield";STRING$(4,128):POKE1024+154,49:POKE1024+155,48:PRINT@156,CHR$(128);"gp";:GOSUB32203180 IF Y=176 THEN PRINT@176,"leather";STRING$(3,128):POKE1024+186,50:POKE1024+187,48:PRINT@188,CHR$(128);"gp";:GOSUB 33103190 IF Y=208 THEN PRINT@208,"chainmail";CHR$(128):POKE1024+218,52:POKE1024+219,48:PRINT@220,CHR$(128);"gp";:GOSUB34003200 IF Y=240 THEN PRINT@240,"platemail";CHR$(128):POKE1024+250,54:POKE1024+251,48:PRINT@252,CHR$(128);"gp";:GOSUB 34903210 GOTO 30903220 '** DISPLAY SHIELD **3230 GOSUB 26803240 PRINT@132,CHR$(240);STRING$(5,243);CHR$(240);3250 PRINT@163,CHR$(247);CHR$(255);CHR$(253);CHR$(255);CHR$(207);STRING$(3,255);CHR$(251);3260 PRINT@194,CHR$(247);STRING$(4,255);CHR$(207);CHR$(255);CHR$(246);CHR$(255);CHR$(255);CHR$(251);3270 PRINT@226,CHR$(255);STRING$(4,207);CHR$(175);STRING$(4,207);CHR$(255);3280 PRINT@258,CHR$(253);STRING$(4,255);CHR$(207);CHR$(254);STRING$(3,255);CHR$(254);3290 PRINT@291,CHR$(253);CHR$(246);STRING$(2,255);CHR$(207);STRING$(3,255);CHR$(246);3300 PRINT@324,CHR$(244);STRING$(5,252);CHR$(240);:RETURN3310 '** DISPLAY LEATHER **3320 GOSUB 26803330 PRINT@69,CHR$(201);STRING$(2,243);CHR$(198);3340 PRINT@101,CHR$(247);STRING$(2,255);CHR$(251);3350 PRINT@161,CHR$(241);CHR$(243);STRING$(2,255);CHR$(155);STRING$(2,147);CHR$(151);STRING$(2,255);CHR$(243);CHR$(242);3360 PRINT@193,STRING$(2,255);CHR$(254);STRING$(6,255);CHR$(253);STRING$(2,255);3370 FOR LP=225TO289STEP32:PRINT@LP,STRING$(2,255);CHR$(245);CHR$(246);STRING$(4,255);CHR$(249);CHR$(250);STRING$(2,255);:NEXTLP3380 PRINT@321,STRING$(2,156);CHR$(244);STRING$(6,255);CHR$(248);STRING$(2,156);3390 PRINT@356,STRING$(2,179);CHR$(209);CHR$(210);STRING$(2,179);:RETURN3400 '** DISPLAY CHAINMAIL **3410 GOSUB 26803420 PRINT@68,CHR$(244);CHR$(251);STRING$(2,211);CHR$(247);CHR$(248);3430 PRINT@101,CHR$(215);STRING$(2,223);CHR$(219);3440 PRINT@161,CHR$(209);STRING$(3,214);CHR$(187);STRING$(2,179);CHR$(183);STRING$(2,214);CHR$(211);CHR$(210);3450 PRINT@193,CHR$(222);STRING$(10,214);CHR$(215);3460 FOR LP=225TO289STEP32:PRINT@LP,CHR$(222);CHR$(215);CHR$(213);STRING$(6,214);CHR$(218);CHR$(222);CHR$(215);:NEXT LP3470 PRINT@321,STRING$(2,188);CHR$(212);STRING$(6,215);CHR$(216);STRING$(2,188);3480 PRINT@356,STRING$(2,243);CHR$(145);CHR$(146);STRING$(2,243);:RETURN3490 '** DISPLAY PLATEMAIL **3500 GOSUB 26803510 PRINT@68,CHR$(237);CHR$(195);CHR$(199);CHR$(203);CHR$(195);CHR$(238);3520 PRINT@101,CHR$(207);STRING$(2,195);CHR$(207);3530 PRINT@133,CHR$(205);STRING$(2,207);CHR$(206);3540 PRINT@193,CHR$(193);CHR$(195);STRING$(2,207);CHR$(235);STRING$(2,227);CHR$(231);STRING$(2,207);CHR$(195);CHR$(194);3550 PRINT@225,STRING$(2,207);CHR$(206);STRING$(6,207);CHR$(205);STRING$(2,207);3560 PRINT@257,STRING$(2,207);CHR$(197);CHR$(207);CHR$(236);CHR$(232);CHR$(228);CHR$(236);CHR$(207);CHR$(202);STRING$(2,207);3570 PRINT@289,STRING$(2,207);CHR$(197);STRING$(2,207);CHR$(234);CHR$(229);STRING$(2,207);CHR$(202);STRING$(2,207);3580 PRINT@321,STRING$(2,207);CHR$(197);STRING$(6,207);CHR$(202);STRING$(2,207);3590 PRINT@353,STRING$(2,236);CHR$(196);STRING$(6,207);CHR$(200);STRING$(2,236);3600 PRINT@388,STRING$(2,227);CHR$(209);CHR$(210);STRING$(2,227);:RETURN3610 '** PURCHASE ARMOR **3620 PRINT@144,"SHIELD    10 GP";:PRINT@176,"LEATHER   20 GP";:PRINT@208,"CHAINMAIL 40 GP";:PRINT@240,"PLATEMAIL 60 GP";3630 IF Y=144 AND SHI$<>"NONE" THEN T$="YOU ALREADY HAVE A SHIELD!":GOSUB 2840:RETURN3640 IF Y<>144 AND ARM$<>"NONE" THEN T$="YOU ALREADY HAVE ARMOUR!":GOSUB 2840:RETURN3650 IF Y=144 AND GP>=10 THEN GOSUB 2700:GP=GP-10:SHI$="0":RETURN3660 IF Y=176 AND GP>=20 THEN GOSUB 2700:GP=GP-20:ARM$="LEA":RETURN3670 IF Y=208 AND GP>=40 THEN GOSUB 2700:GP=GP-40:ARM$="CHA":RETURN3680 IF Y=240 AND GP>=60 THEN GOSUB 2700:GP=GP-60:ARM$="PLA":RETURN3690 T$="NOT ENOUGH GOLD!":GOSUB 28403700 RETURN3710 '** SELL ARMOUR **3720 PRINT@144,"SHIELD    10 GP";:PRINT@176,"LEATHER   20 GP";:PRINT@208,"CHAINMAIL 40 GP";:PRINT@240,"PLATEMAIL 60 GP";3730 IF Y=144 AND SHI$="NONE" THEN T$="YOU HAVE NO SHIELD!":GOSUB 2840:RETURN3740 IF Y<>144 AND ARM$="NONE" THEN T$="YOU HAVE NO ARMOUR!":GOSUB 2840:RETURN3750 IF Y=144 AND SHI$="1" THEN GP=GP+5:T$="THANK YOU, SIR!":GOSUB 2840:SHI$="NONE":RETURN3760 IF Y=176 AND ARM$="LEA" THEN GP=GP+10:T$="THANK YOU, SIR!":GOSUB 2840:ARM$="NONE":RETURN3770 IF Y=208 AND ARM$="CHA" THEN GP=GP+20:T$="THANK YOU, SIR!":GOSUB 2840:ARM$="NONE":RETURN3780 IF Y=240 AND ARM$="PLA" THEN GP=GP+30:T$="THANK YOU, SIR!":GOSUB 2840:ARM$="NONE":RETURN3790 T$="YOU DO NOT HAVE THAT, SIR!":GOSUB 2840:RETURN3800 GOTO 38003810 '** DONE **3820 OPEN"O",#1,"CHAR.DAT"3830 WRITE#1,NAME$3840 WRITE#1,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL3850 WRITE#1,W$,ARM$,SHI$3860 CLOSE #13870 KILL NAME$+".DAT":COPY "CHAR.DAT" TO NAME$+".DAT"3880 CLS:RUN"INN"3890 '** LOAD CHARACTER FILE **3900 OPEN"I",#1,"CHAR.DAT"3910 INPUT #1,NAME$:INPUT #1,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,LVL:INPUT#1,W$,ARM$,SHI$3920 CLOSE #13930 IF W$="NONE" THEN W$="HAN"3940 RETURN