100 POKE36879,136:PRINTCHR$(14)
110 PO=15:DIMO%(3),O$(3):TR=0
120 FORI=0TO3:READO$(I):NEXT
130 DATASWORD,STAFF,PALANTIR,TALISMAN
140 O%(INT(RND(1)*2))=1
150 PRINT"...OU HAVE ENTERED":PRINT"A ";
160 D=INT(RND(1)*4):IFD=0THENPRINT".N EVIL SMELLING";
170 IFD=1THENPRINT"HOMELY";
180 IFD=2THENPRINT"DANK AND WET";
190 IFD=3THENPRINT"DARK, MYSTIC";
200 D=INT(RND(1)*4+1):IFD=1THENPRINT" BARN"
210 IFD=2THENPRINT" DUNGEON"
220 IFD=3THENPRINT" CASTLE"
230 IFD=4THENPRINT" TOWER"
240 C=INT(RND(1)*6):PRINT",WHICH CONTAINS A":C1=C
250 IFC=0THENPRINT"MYSTERIOUS OBJECT.":Z=INT(RND(1)*4)
260 IFC=1THENPRINT"BOOK OF SPELLS."
270 IFC=2THENPRINT"HORDE OF TREASURE."
280 IFC=3THENPRINT"SMALL ANIMAL RUMAGING IN THE CORNER."
290 IFC=4THENPRINT"MONSTER GUARDING IT."
300 IFC=5THENPRINT"DRAGON BLOCKING YOUR  WAY."
310 IFC<3ANDRND(1)>.6THENPRINT".HERE IS ALSO A       MONSTER.":C1=3
320 IFPO<1THENPRINT"..HOU ART SLAIN":GOTO1100
330 IFPO<15THENPO=PO+O%(3)
340 FORI=0TO3:IFRND(1)>.9THENPO=PO-O%(I)
350 NEXT
360 PRINT:PRINT".HAT NOW":INPUTA$
370 V$="":N$="":P=1:FORI=1TOLEN(A$)
380 IFMID$(A$,I,1)=" "THENP=2:GOTO410
390 IFP=1THENV$=V$+MID$(A$,I,1)
400 IFP=2THENN$=N$+MID$(A$,I,1)
410 NEXTI
420 PRINT".."V$" "N$"."
430 IFV$="SLAY"THEN650
440 IFV$="GO"THEN710
450 IFV$="PICK-UP"THEN740
460 IFV$="EXAMINE"THEN770
470 IFV$="DROP"THEN810
480 IFV$="GAZE-INTO"THEN840
490 IFV$="SPELL"THEN920
500 IFV$="RECOVER"THEN1010
510 IFV$="READ"THEN1060
520 IFV$="INVENTORY"THEN1100
530 PRINT".. DON'T UNDERSTAND..":GOTO320
540 IFC>3ANDRND(1)>.7THENC1=C1+1
550 FORI=1TO750:NEXT
560 IFC1=1ANDRND(1)>.9THENPRINT".HE ROOF FALLS IN!":PO=PO-2:GOTO320
570 IFC1=2ANDRND(1)>.9THENPRINT".OU FELL DOWN A PIT INTHE FLOOR.":PO=PO-3:GOTO320
580 IFC1=3THENPRINT".HE ANIMAL KEEPS IT'S  DISTANCE."
590 IFC1=4ANDRND(1)>.6THENPRINT".HE MONSTER ADVANCES."
600 IFC1>5THENC1=5
610 IFC1<5ORRND(1)<.7THEN320
620 PRINT".HE MONSTER ATTACKS   YOU.":PO=PO-INT(RND(1)*4)
630 IFRND(1)>.7THENPRINT".E KILLS YOU!":PO=0:GOTO1100
640 GOTO320
650 IFC1<3THENPRINT".HERE IS NO MONSTER.":GOTO540
660 IFO%(0)=0THENPRINT"..OU HAVE NO WEAPONS!":GOTO540
670 PO=PO-INT(RND(1)*3)
680 IFC=5ANDRND(1)>.6THENPRINT".HE DRAGON LIVES.":GOTO540
690 PRINT".HE BEAST IS DEAD.":C1=0
700 GOTO540
710 IFC1>2ANDRND(1)<C1/7THENPRINT".HE MONSTER WON'T LET YOU.":GOTO540
720 IFN$<>"LEFT"ANDN$<>"RIGHT"ANDN$<>"FORWARDS"THEN480
730 PRINT".K":GOTO150
740 IFN$<>O$(Z)THENPRINT".HERE IS NO "N$:GOTO540
750 O%(Z)=O%(Z)+1:PRINT".K"
760 GOTO540
770 IFC1>3THENPRINT".HIS ANGERS THE BEAST.":C1=C1+1:GOTO550
780 IFC>0THENPRINT".HERE IS NOTHING TO   EXAMINE.":GOTO540
790 PRINT".HE OBJECT TURNS OUT  TO BE A "O$(Z)"."
800 GOTO540
810 FORI=0TO3:IFN$=O$(I)ANDO%(I)=0THENPRINT".OU DON'T HAVE A "N$:GOTO540
820 IFN$=O$(I)THENO%(I)=O%(I)-1:Z=I:PRINT".K"
830 NEXT:GOTO540
840 IFN$<>"PALANTIR"THENPRINT".OU CAN'T GAZE AT THAT.":GOTO540
850 IFO%(2)=0THENPRINT".OU DON'T HAVE A      PALANTIR.":GOTO540
860 IFRND(1)>.3THEN900
870 IFRND(1)>.5THENPRINT".HE GLOBE REMAINS BLANK.":GOTO540
880 IFRND(1)>.5THENPRINT".OU DISCOVER A MONSTER LURKING IN THE SHADOWS.":C1=3:GOTO550
890 PRINT".OU SEE A GREAT       TREASURE IN YOUR      JOURNEYS.":GOTO320
900 PRINT".OU FEEL WEAKER."
910 PO=PO-1:GOTO540
920 IFO%(1)=0THENPRINT".OU HAVEN'T THE MEANS TO CAST SPELLS.":GOTO320
930 IFN$<>"MONSTER"THENPRINT".OU CAN'T SPELL THAT.":GOTO540
940 IFC1<3THENPRINT".HERE IS NO MONSTER.":GOTO320
950 IFRND(1)<.8THEN980
960 PRINT".OUR SPELL FAILED.":PRINT".T HAS ANGERED THE    BEAST."::C1=C1+1:GOTO550
970 GOTO540
980 PRINT".HE SPELL WORKED.":C1=0
990 IFRND(1)>.6THENPRINT".UT YOUR STAFF SNAPPEDWITH THE STRAIN.":O%(1)=O%(1)-1
1000 GOTO320
1010 IFC<>2THENPRINT".HERE IS NOTHING TO   RECOVER.":GOTO540
1020 IFN$<>"TREASURE"THENPRINT".HAT CANNOT BE        RECOVERED.":GOTO540
1030 IFC1>2ANDRND(1)>.3THENPRINT".HE MONSTER WON'T LET YOU.":C1=C1+1:GOTO550
1040 TR=TR+INT(RND(1)*101)+100
1050 PRINT".K"::GOTO320
1060 IFC<>1THENPRINT".HERE IS NO BOOK.":GOTO540
1070 IFN$<>"BOOK"THEN530
1080 PRINT".OU FEEL FAINT":PO=PO-2
1090 GOTO320
1100 PRINT".OU HAVE"PO"STRENGTH"
1110 PRINT".OU HAVE"TR"SILVER":PRINT"COINS."
1120 PRINT".OU HAVE":FORI=0TO3:PRINTO%(I)O$(I);
1130 IFO%(I)<>1THENPRINT"S";
1140 PRINT:NEXT
1150 IFPO>0THEN540
